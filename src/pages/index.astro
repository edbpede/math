---
/**
 * Landing Page
 *
 * Clean, welcoming entry point for new users with language auto-detection,
 * feature highlights, and clear call-to-action buttons.
 *
 * Requirements:
 * - 14.1: Clean landing page with brief explanation, language selector, and CTAs
 *
 * Task: 9.2
 */

import MainLayout from '@/components/layouts/MainLayout.astro'
import LanguageSelector from '@/components/islands/LanguageSelector'
import { $t, detectBrowserLocale, initI18n } from '@/lib/i18n'

// Detect browser language and initialize i18n
const browserLocale = detectBrowserLocale()
await initI18n(browserLocale)

// Get translations
const t = await $t.get()

// Check if user is authenticated
const user = Astro.locals.user

// Redirect authenticated users to dashboard
if (user) {
  return Astro.redirect('/dashboard')
}
---

<MainLayout hideNav={true} title={t('landing.welcome.title')}>
  <!-- Landing Page Container -->
  <div class="min-h-screen flex flex-col">
    <!-- Header with Language Selector -->
    <div class="w-full bg-white border-b border-gray-200">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <div class="flex justify-between items-center">
          <!-- Logo/Title -->
          <div class="flex items-center gap-3">
            <svg
              class="w-8 h-8 text-blue-600"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              aria-hidden="true"
            >
              <path d="M12 2L2 7l10 5 10-5-10-5z"/>
              <path d="M2 17l10 5 10-5"/>
              <path d="M2 12l10 5 10-5"/>
            </svg>
            <h1 class="text-xl font-bold text-gray-900 sm:text-2xl">
              {t('common.app.title')}
            </h1>
          </div>

          <!-- Language Selector -->
          <div class="flex-shrink-0">
            <LanguageSelector variant="full" layout="horizontal" client:idle />
          </div>
        </div>
      </div>
    </div>

    <!-- Hero Section -->
    <div class="flex-1 flex flex-col justify-center bg-gradient-to-b from-white to-gray-50">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 sm:py-16 md:py-20">
        <div class="text-center">
          <!-- Welcome Message -->
          <h2 class="text-4xl font-bold text-gray-900 mb-4 sm:text-5xl md:text-6xl">
            {t('landing.welcome.title')}
          </h2>

          <p class="text-lg text-gray-600 mb-8 max-w-2xl mx-auto sm:text-xl md:text-2xl">
            {t('landing.welcome.subtitle')}
          </p>

          <!-- Call to Action Buttons -->
          <div class="flex flex-col gap-4 items-center justify-center mb-16 sm:flex-row sm:gap-6">
            <!-- Primary CTA: Start Practice -->
            <a
              href="/onboarding"
              class="w-full sm:w-auto px-8 py-4 bg-blue-600 text-white text-lg font-semibold rounded-lg shadow-lg hover:bg-blue-700 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all duration-200 active:bg-blue-800 min-w-[200px] text-center"
            >
              {t('landing.cta.startPractice')}
            </a>

            <!-- Secondary CTA: I have a practice number -->
            <a
              href="/login"
              class="w-full sm:w-auto px-8 py-4 bg-white text-blue-600 text-lg font-semibold rounded-lg border-2 border-blue-600 hover:bg-blue-50 focus:outline-none focus:ring-4 focus:ring-blue-300 transition-all duration-200 active:bg-blue-100 min-w-[200px] text-center"
            >
              {t('landing.cta.haveNumber')}
            </a>
          </div>

          <!-- Feature Cards Grid -->
          <div class="grid grid-cols-1 gap-6 max-w-4xl mx-auto sm:grid-cols-2 lg:gap-8">
            <!-- Feature 1: Privacy -->
            <article class="bg-white p-6 rounded-lg shadow-md border border-gray-200 hover:shadow-lg transition-shadow duration-200">
              <div class="flex flex-col items-center text-center">
                <div class="w-12 h-12 mb-4 text-blue-600" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                    <path d="M7 11V7a5 5 0 0110 0v4"/>
                  </svg>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">
                  {t('landing.features.private.title')}
                </h3>
                <p class="text-gray-600">
                  {t('landing.features.private.description')}
                </p>
              </div>
            </article>

            <!-- Feature 2: Curriculum -->
            <article class="bg-white p-6 rounded-lg shadow-md border border-gray-200 hover:shadow-lg transition-shadow duration-200">
              <div class="flex flex-col items-center text-center">
                <div class="w-12 h-12 mb-4 text-blue-600" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                    <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/>
                  </svg>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">
                  {t('landing.features.curriculum.title')}
                </h3>
                <p class="text-gray-600">
                  {t('landing.features.curriculum.description')}
                </p>
              </div>
            </article>

            <!-- Feature 3: Unlimited -->
            <article class="bg-white p-6 rounded-lg shadow-md border border-gray-200 hover:shadow-lg transition-shadow duration-200">
              <div class="flex flex-col items-center text-center">
                <div class="w-12 h-12 mb-4 text-blue-600" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                  </svg>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">
                  {t('landing.features.unlimited.title')}
                </h3>
                <p class="text-gray-600">
                  {t('landing.features.unlimited.description')}
                </p>
              </div>
            </article>

            <!-- Feature 4: Offline -->
            <article class="bg-white p-6 rounded-lg shadow-md border border-gray-200 hover:shadow-lg transition-shadow duration-200">
              <div class="flex flex-col items-center text-center">
                <div class="w-12 h-12 mb-4 text-blue-600" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                    <circle cx="12" cy="12" r="3"/>
                  </svg>
                </div>
                <h3 class="text-xl font-semibold text-gray-900 mb-2">
                  {t('landing.features.offline.title')}
                </h3>
                <p class="text-gray-600">
                  {t('landing.features.offline.description')}
                </p>
              </div>
            </article>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 py-6">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <p class="text-center text-sm text-gray-600">
          {t('common.app.tagline')}
        </p>
      </div>
    </footer>
  </div>
</MainLayout>
