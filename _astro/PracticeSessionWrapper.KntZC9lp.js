import{d as e,f as t,m as s,b as i,g as r,t as n,h as a,i as l,j as o,l as d,n as c,w as u,r as g,u as b,F as x,k as m,B as h,M as f,v}from"./solid-core.DXeZPQOr.js";import{$ as p,g as y}from"./exercises.CmwZ4dJn.js";import{d as w,e as S,l as C,u as k}from"./island-dashboard.Bt_Br7pH.js";import{E as $,e as I}from"./island-practice.Crw8XKdE.js";import"./mastery.BYaRoLpV.js";import"./supabase.BYn26wLR.js";import"./vendor.CmgFkl6N.js";import"./qrcode.B15vZz8I.js";var A=n('<div class="mb-8 p-4 bg-blue-50 border border-blue-200 rounded-lg"role=status aria-live=polite><p class="text-blue-800 text-sm">'),D=n('<div><div class=mb-8><h1 class="text-3xl font-bold text-gray-900 mb-2"></h1><p class="text-lg text-gray-600"></p></div><!$><!/><div class=mb-8><label id=difficulty-label class="block text-lg font-semibold text-gray-800 mb-4"></label><div role=radiogroup aria-labelledby=difficulty-label class=space-y-3></div></div><div class=mb-8><label id=count-label class="block text-lg font-semibold text-gray-800 mb-4"></label><div role=radiogroup aria-labelledby=count-label class=space-y-3></div></div><div class=mt-8><button type=button class="w-full py-4 px-6 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-lg rounded-lg transition-colors min-h-[44px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-md hover:shadow-lg">'),T=n('<div class="w-full h-full rounded-full bg-white scale-40">'),U=n('<button type=button role=radio><div class="flex items-start"><div aria-hidden=true></div><div class=flex-1><div class="font-semibold text-gray-900 mb-1"></div><div class="text-sm text-gray-600">');const j=e=>{const n=s(p),[b,x]=i(e.isFirstTime?"A":"Auto"),[m,h]=i(20),f=()=>{e.onStart({difficulty:b(),exerciseCount:m()})},v=[{value:"Auto",key:"auto"},{value:"A",key:"a"},{value:"B",key:"b"},{value:"C",key:"c"}],y=[{value:10,key:"10"},{value:20,key:"20"},{value:30,key:"30"}];return(()=>{var s=r(D),i=s.firstChild,p=i.firstChild,w=p.nextSibling,S=i.nextSibling,[C,k]=a(S.nextSibling),$=C.nextSibling,I=$.firstChild,j=I.nextSibling,E=$.nextSibling,F=E.firstChild,M=F.nextSibling,B=E.nextSibling.firstChild;return l(p,()=>n()("exercises.session.setup.title")),l(w,()=>n()("exercises.session.setup.subtitle")),l(s,t(o,{get when(){return e.isFirstTime},get children(){var e=r(A),t=e.firstChild;return l(t,()=>n()("exercises.session.setup.firstTimeNotice")),e}}),C,k),l(I,()=>n()("exercises.session.setup.difficulty.label")),l(j,()=>v.map(e=>{const s=()=>b()===e.value;return i=r(U),a=i.firstChild.firstChild,m=a.nextSibling.firstChild,h=m.nextSibling,i.$$click=()=>x(e.value),l(a,t(o,{get when(){return s()},get children(){return r(T)}})),l(m,()=>n()(`exercises.session.setup.difficulty.${e.key}`)),l(h,()=>n()(`exercises.session.setup.difficulty.${e.key}Description`)),d(e=>{var t=s(),r=`\n                  w-full text-left p-4 rounded-lg border-2 transition-all\n                  min-h-[44px] cursor-pointer\n                  ${s()?"border-blue-500 bg-blue-50 shadow-md":"border-gray-300 bg-white hover:border-blue-300 hover:bg-blue-50"}\n                  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n                `,n=`\n                      flex-shrink-0 w-5 h-5 rounded-full border-2 mt-0.5 mr-3\n                      ${s()?"border-blue-500 bg-blue-500":"border-gray-400 bg-white"}\n                    `;return t!==e.e&&c(i,"aria-checked",e.e=t),r!==e.t&&u(i,e.t=r),n!==e.a&&u(a,e.a=n),e},{e:void 0,t:void 0,a:void 0}),g(),i;var i,a,m,h})),l(F,()=>n()("exercises.session.setup.exerciseCount.label")),l(M,()=>y.map(e=>{const s=()=>m()===e.value;return i=r(U),a=i.firstChild.firstChild,b=a.nextSibling.firstChild,x=b.nextSibling,i.$$click=()=>h(e.value),l(a,t(o,{get when(){return s()},get children(){return r(T)}})),l(b,()=>n()(`exercises.session.setup.exerciseCount.${e.key}`)),l(x,()=>n()(`exercises.session.setup.exerciseCount.${e.key}Description`)),d(e=>{var t=s(),r=`\n                  w-full text-left p-4 rounded-lg border-2 transition-all\n                  min-h-[44px] cursor-pointer\n                  ${s()?"border-blue-500 bg-blue-50 shadow-md":"border-gray-300 bg-white hover:border-blue-300 hover:bg-blue-50"}\n                  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n                `,n=`\n                      flex-shrink-0 w-5 h-5 rounded-full border-2 mt-0.5 mr-3\n                      ${s()?"border-blue-500 bg-blue-500":"border-gray-400 bg-white"}\n                    `;return t!==e.e&&c(i,"aria-checked",e.e=t),r!==e.t&&u(i,e.t=r),n!==e.a&&u(a,e.a=n),e},{e:void 0,t:void 0,a:void 0}),g(),i;var i,a,b,x})),B.$$click=f,l(B,()=>n()("exercises.session.setup.startButton")),d(()=>u(s,`session-setup ${e.class||""}`)),g(),s})()};function E(e){return t($,{componentName:"SessionSetup",errorMessageKey:"errors.session.setupFailed",get children(){return t(j,e)}})}e(["click"]);var F=n('<div class="mb-8 p-6 bg-yellow-50 border border-yellow-200 rounded-lg"><h2 class="text-lg font-semibold text-yellow-900 mb-4 text-center">Achievements Unlocked!</h2><div class="grid grid-cols-1 sm:grid-cols-2 gap-3">'),M=n('<div class=text-center><div class="text-3xl font-bold text-yellow-600 mb-1"></div><div class="text-sm text-gray-600">'),B=n('<div class=text-center><div class="text-3xl font-bold text-gray-600 mb-1"></div><div class="text-sm text-gray-600">'),P=n('<div class="text-center col-span-2"><div class="text-3xl font-bold text-indigo-600 mb-1">+<!$><!/></div><div class="text-sm text-gray-600">'),G=n('<div><div class="text-center mb-8"><div class="text-6xl mb-4"aria-hidden=true>üéâ</div><h1 class="text-3xl font-bold text-gray-900 mb-2"></h1><p class="text-xl text-gray-700"></p></div><!$><!/><div class="mb-8 p-6 bg-white border border-gray-200 rounded-lg shadow-sm"><h2 class="text-xl font-semibold text-gray-900 mb-6"></h2><div class="grid grid-cols-2 gap-6"><div class=text-center><div class="text-3xl font-bold text-blue-600 mb-1"></div><div class="text-sm text-gray-600"></div></div><div class=text-center><div class="text-3xl font-bold text-green-600 mb-1"></div><div class="text-sm text-gray-600"></div></div><div class=text-center><div class="text-3xl font-bold text-purple-600 mb-1"><!$><!/>%</div><div class="text-sm text-gray-600"></div></div><div class=text-center><div class="text-3xl font-bold text-orange-600 mb-1"></div><div class="text-sm text-gray-600"></div></div><!$><!/><!$><!/><!$><!/></div></div><div class=space-y-3><button type=button class="w-full py-4 px-6 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-lg rounded-lg transition-colors min-h-[44px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-md hover:shadow-lg"></button><button type=button class="w-full py-4 px-6 bg-green-600 hover:bg-green-700 text-white font-semibold text-lg rounded-lg transition-colors min-h-[44px] focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 shadow-md hover:shadow-lg"></button><button type=button class="w-full py-4 px-6 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold text-lg rounded-lg transition-colors min-h-[44px] focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 shadow-sm hover:shadow-md">'),R=n('<div class="flex items-center p-3 bg-white rounded-lg shadow-sm"><span class="text-2xl mr-3"aria-hidden=true>üèÜ</span><span class="text-sm font-medium text-gray-800">');const N=e=>{const i=s(p),n=b(()=>0===e.stats.totalExercises?0:Math.round(e.stats.correctCount/e.stats.totalExercises*100)),c=b(()=>{const t=Math.round(e.stats.avgTimeSeconds);return`${Math.floor(t/60)}:${(t%60).toString().padStart(2,"0")}`}),f=b(()=>{const e=n();return e>=90?i()("exercises.session.summary.excellentWork"):e>=70?i()("exercises.session.summary.goodProgress"):i()("exercises.session.summary.keepPracticing")}),v=b(()=>{const t=[];return 100===n()&&t.push("perfectScore"),0===e.stats.hintsUsed&&e.stats.correctCount>0&&t.push("noHints"),e.stats.avgTimeSeconds<30&&t.push("fastLearner"),e.stats.totalExercises>=30&&t.push("persistent"),t});return(()=>{var s=r(G),b=s.firstChild,p=b.firstChild.nextSibling,y=p.nextSibling,w=b.nextSibling,[S,C]=a(w.nextSibling),k=S.nextSibling,$=k.firstChild,I=$.nextSibling,A=I.firstChild,D=A.firstChild,T=D.nextSibling,U=A.nextSibling,j=U.firstChild,E=j.nextSibling,N=U.nextSibling,K=N.firstChild,V=K.firstChild,[q,H]=a(V.nextSibling);q.nextSibling;var J=K.nextSibling,L=N.nextSibling,W=L.firstChild,z=W.nextSibling,O=L.nextSibling,[Q,X]=a(O.nextSibling),Y=Q.nextSibling,[Z,_]=a(Y.nextSibling),ee=Z.nextSibling,[te,se]=a(ee.nextSibling),ie=k.nextSibling.firstChild,re=ie.nextSibling,ne=re.nextSibling;return l(p,()=>i()("exercises.session.summary.title")),l(y,f),l(s,t(o,{get when(){return v().length>0},get children(){var e=r(F),s=e.firstChild.nextSibling;return l(s,t(x,{get each(){return v()},children:e=>{return t=r(R),s=t.firstChild.nextSibling,l(s,()=>i()(`exercises.session.summary.achievements.${e}`)),t;var t,s}})),e}}),S,C),l($,()=>i()("exercises.session.summary.statistics.title")),l(D,()=>e.stats.totalExercises),l(T,()=>i()("exercises.session.summary.statistics.total")),l(j,()=>e.stats.correctCount),l(E,()=>i()("exercises.session.summary.statistics.correct")),l(K,n,q,H),l(J,()=>i()("exercises.session.summary.statistics.accuracy")),l(W,c),l(z,()=>i()("exercises.session.summary.statistics.avgTime")),l(I,t(o,{get when(){return e.stats.hintsUsed>0},get children(){var t=r(M),s=t.firstChild,n=s.nextSibling;return l(s,()=>e.stats.hintsUsed),l(n,()=>i()("exercises.session.summary.statistics.hintsUsed")),t}}),Q,X),l(I,t(o,{get when(){return e.stats.skippedCount>0},get children(){var t=r(B),s=t.firstChild,n=s.nextSibling;return l(s,()=>e.stats.skippedCount),l(n,()=>i()("exercises.session.summary.statistics.skipped")),t}}),Z,_),l(I,t(o,{get when(){return m(()=>void 0!==e.masteryGain)()&&e.masteryGain>0},get children(){var t=r(P),s=t.firstChild,n=s.firstChild.nextSibling,[o,d]=a(n.nextSibling),c=s.nextSibling;return l(s,()=>e.masteryGain,o,d),l(c,()=>i()("exercises.session.summary.statistics.masteryGain")),t}}),te,se),h(ie,"click",e.onPracticeAgain),l(ie,()=>i()("exercises.session.summary.actions.practiceAgain")),h(re,"click",e.onViewProgress),l(re,()=>i()("exercises.session.summary.actions.viewProgress")),h(ne,"click",e.onReturnToDashboard),l(ne,()=>i()("exercises.session.summary.actions.dashboard")),d(()=>u(s,`session-summary ${e.class||""}`)),g(),s})()};function K(e){return t($,{componentName:"SessionSummary",errorMessageKey:"errors.session.summaryFailed",get children(){return t(N,e)}})}e(["click"]);var V=n('<div class="text-center py-12"><div class="text-red-600 text-xl font-semibold mb-4">Error</div><p class="text-gray-700 mb-6"></p><button type=button class="py-3 px-6 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">Try Again'),q=n("<div>");function H(e){const[s,n]=i("setup"),[a,o]=i(""),[c,x]=i([]),[h,p]=i(0),[$,A]=i(""),[D,T]=i(0),[U,j]=i(0),[F,M]=i(0),[B,P]=i(0),[G,R]=i(Date.now()),N=b(()=>c()[h()]||null),H=b(()=>h()>=c().length-1),J=async t=>{try{const s=await w(e.userId,e.gradeRange,e.competencyAreaId);o(s.id);const i="Auto"===t.difficulty?void 0:t.difficulty,r=await y({competencyAreaId:e.competencyAreaId,gradeRange:e.gradeRange,difficulty:i},t.exerciseCount,{locale:e.locale});x(r),p(0),R(Date.now()),n("practicing")}catch(s){A("Failed to start session. Please try again."),n("error")}},L=async t=>{try{const s=N();if(!s)return;const i=Math.round((Date.now()-G())/1e3);P(B()+i),t.correct&&T(D()+1),j(U()+t.hintsUsed),await C({userId:e.userId,sessionId:a(),templateId:s.templateId,competencyAreaId:e.competencyAreaId,skillId:s.metadata.skillId||"unknown",difficulty:s.metadata.difficulty,isBinding:s.metadata.isBinding,correct:t.correct,timeSpentSeconds:i,hintsUsed:t.hintsUsed,userAnswer:t.userAnswer});const r=h()+1;r%5==0&&await k(a(),r,D()),H()?await z():(p(h()+1),R(Date.now()))}catch(s){H()?await z():(p(h()+1),R(Date.now()))}},W=async t=>{try{const s=N();if(!s)return;const i=Math.round((Date.now()-G())/1e3);P(B()+i),M(F()+1),j(U()+t.hintsUsed),await C({userId:e.userId,sessionId:a(),templateId:s.templateId,competencyAreaId:e.competencyAreaId,skillId:s.metadata.skillId||"unknown",difficulty:s.metadata.difficulty,isBinding:s.metadata.isBinding,correct:!1,timeSpentSeconds:i,hintsUsed:t.hintsUsed,userAnswer:t.userAnswer||""}),H()?await z():(p(h()+1),R(Date.now()))}catch(s){H()?await z():(p(h()+1),R(Date.now()))}},z=async()=>{try{const e=c().length,t=e>0?B()/e:0;await S(a(),e,D(),t),n("complete")}catch(e){n("complete")}},O=()=>{o(""),x([]),p(0),T(0),j(0),M(0),P(0),n("setup")},Q=()=>{window.location.href="/dashboard"},X=()=>{window.location.href="/dashboard"},Y=b(()=>({totalExercises:c().length,correctCount:D(),avgTimeSeconds:c().length>0?B()/c().length:0,hintsUsed:U(),skippedCount:F()}));return Z=r(q),l(Z,t(v,{get children(){return[t(f,{get when(){return"setup"===s()},get children(){return t(E,{get isFirstTime(){return e.isFirstTime},onStart:J})}}),t(f,{get when(){return m(()=>"practicing"===s())()&&N()},get children(){return t(I,{get exercises(){return c()},get currentIndex(){return h()},get sessionId(){return a()},onExerciseComplete:L,onSkip:W,onSessionComplete:z})}}),t(f,{get when(){return"complete"===s()},get children(){return t(K,{get stats(){return Y()},onPracticeAgain:O,onViewProgress:Q,onReturnToDashboard:X})}}),t(f,{get when(){return"error"===s()},get children(){var e=r(V),t=e.firstChild.nextSibling,s=t.nextSibling;return l(t,$),s.$$click=()=>n("setup"),g(),e}})]}})),d(()=>u(Z,`practice-session-wrapper max-w-4xl mx-auto px-4 py-8 ${e.class||""}`)),Z;var Z}e(["click"]);export{H as default};
