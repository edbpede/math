import{d as Q,c,j as W,o as X,b as z,k as Z,g as m,t as g,u as ee,i as n,S as A,e as te,s as le,h as se,r as B,m as ne}from"./store.C-Iyz76Y.js";import{m as oe,$ as ie}from"./store.BEcAnxVL.js";import{c as ae}from"./focus-trap.CegowVgX.js";var re=g('<div class="fixed bottom-0 left-0 right-0 z-50 bg-white border-t-2 border-blue-500 shadow-lg md:bottom-4 md:left-4 md:right-auto md:max-w-md md:rounded-lg md:border-2"role=dialog aria-labelledby=install-prompt-title aria-describedby=install-prompt-description><div class=p-4><div class="flex items-start gap-3 mb-3"><div class="flex-shrink-0 w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center"><svg class="w-8 h-8 text-white"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg></div><div class="flex-1 min-w-0"><h3 id=install-prompt-title class="text-lg font-semibold text-gray-900 mb-1"></h3><p id=install-prompt-description class="text-sm text-gray-600"></p></div><button type=button class="flex-shrink-0 p-2 text-gray-400 hover:text-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 touch-target"><svg class="w-5 h-5"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M6 18L18 6M6 6l12 12"></path></svg></button></div><ul class="space-y-2 mb-4 text-sm text-gray-600"><li class="flex items-center gap-2"><svg class="w-4 h-4 text-green-500 flex-shrink-0"fill=currentColor viewBox="0 0 20 20"><path fill-rule=evenodd d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"clip-rule=evenodd></path></svg><span></span></li><li class="flex items-center gap-2"><svg class="w-4 h-4 text-green-500 flex-shrink-0"fill=currentColor viewBox="0 0 20 20"><path fill-rule=evenodd d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"clip-rule=evenodd></path></svg><span></span></li><li class="flex items-center gap-2"><svg class="w-4 h-4 text-green-500 flex-shrink-0"fill=currentColor viewBox="0 0 20 20"><path fill-rule=evenodd d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"clip-rule=evenodd></path></svg><span></span></li></ul><div class="flex gap-2"><button type=button class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed touch-target"></button><button type=button class="px-4 py-2 text-gray-600 hover:text-gray-800 font-medium rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 touch-target">'),de=g('<div class="fixed inset-0 bg-black bg-opacity-25 z-40 md:hidden"aria-hidden=true>'),ce=g('<span class="flex items-center justify-center gap-2"><svg class="animate-spin h-4 w-4"fill=none viewBox="0 0 24 24"><circle class=opacity-25 cx=12 cy=12 r=10 stroke=currentColor stroke-width=4></circle><path class=opacity-75 fill=currentColor d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><span>');const j="math-install-prompt-dismissed",pe=30;function ge(){const t=oe(ie),[T,p]=c(null),[h,o]=c(!1),[v,w]=c(!1),[b,x]=c(!1);let f;const y=ae(()=>f,{preventScroll:!0,allowEscape:!0,onDeactivate:()=>i()});W(()=>{h()&&!v()?y.activate():y.deactivate()});const U=()=>{if(typeof window>"u"||typeof localStorage>"u")return!1;try{const e=localStorage.getItem(j);if(!e)return!1;const l=parseInt(e,10);return(Date.now()-l)/(1e3*60*60*24)<pe}catch{return!1}},H=()=>{if(typeof window>"u")return;const e=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;w(e)},$=e=>{e.preventDefault(),p(e),U()||o(!0),console.log("[InstallPrompt] Install prompt available")},S=()=>{console.log("[InstallPrompt] App installed successfully"),w(!0),o(!1),p(null)},N=async()=>{const e=T();if(e){x(!0);try{await e.prompt();const{outcome:l}=await e.userChoice;console.log(`[InstallPrompt] User response: ${l}`),console.log(l==="accepted"?"[InstallPrompt] User accepted the install prompt":"[InstallPrompt] User dismissed the install prompt"),p(null),o(!1)}catch(l){console.error("[InstallPrompt] Install failed:",l)}finally{x(!1)}}},i=()=>{if(typeof window<"u"&&typeof localStorage<"u")try{localStorage.setItem(j,Date.now().toString())}catch(e){console.error("[InstallPrompt] Failed to save dismissal:",e)}o(!1),console.log("[InstallPrompt] User dismissed install prompt")};return X(()=>{typeof window>"u"||(H(),window.addEventListener("beforeinstallprompt",$),window.addEventListener("appinstalled",S),console.log("[InstallPrompt] Component mounted"))}),Z(()=>{typeof window<"u"&&(window.removeEventListener("beforeinstallprompt",$),window.removeEventListener("appinstalled",S))}),z(A,{get when(){return ne(()=>!!h())()&&!v()},get children(){return[(()=>{var e=m(re),l=e.firstChild,u=l.firstChild,I=u.firstChild,_=I.nextSibling,k=_.firstChild,R=k.nextSibling,C=_.nextSibling,P=u.nextSibling,D=P.firstChild,F=D.firstChild,Y=F.nextSibling,E=D.nextSibling,K=E.firstChild,O=K.nextSibling,V=E.nextSibling,q=V.firstChild,G=q.nextSibling,J=P.nextSibling,a=J.firstChild,M=a.nextSibling,L=f;return typeof L=="function"?ee(L,e):f=e,n(k,()=>t()("pwa.install.title")),n(R,()=>t()("pwa.install.description")),C.$$click=i,n(Y,()=>t()("pwa.install.feature.offline")),n(O,()=>t()("pwa.install.feature.faster")),n(G,()=>t()("pwa.install.feature.homescreen")),a.$$click=N,n(a,z(A,{get when(){return!b()},get fallback(){return(()=>{var s=m(ce),r=s.firstChild,d=r.nextSibling;return n(d,()=>t()("common.status.loading")),s})()},get children(){return t()("pwa.install.button")}})),M.$$click=i,n(M,()=>t()("pwa.install.dismiss")),te(s=>{var r=t()("common.actions.close"),d=b();return r!==s.e&&le(C,"aria-label",s.e=r),d!==s.t&&se(a,"disabled",s.t=d),s},{e:void 0,t:void 0}),B(),e})(),(()=>{var e=m(de);return e.$$click=i,B(),e})()]}})}Q(["click"]);export{ge as default};
