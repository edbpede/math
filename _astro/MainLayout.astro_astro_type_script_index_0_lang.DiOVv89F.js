import{toast as e}from"./ToastNotification.8BzCrt3X.js";import{w as n,l as o,b as s,d as r}from"./island-practice.Crw8XKdE.js";import"./solid-core.DXeZPQOr.js";import"./exercises.CmwZ4dJn.js";const t={showToasts:!0,logToConsole:!1,shouldHandleError:()=>!0,getToastMessage:()=>"Noget gik galt. PrÃ¸v venligst igen."};let i=!1,a=[];function d(e){const n=e.message.toLowerCase();return n.includes("network")||n.includes("fetch")||n.includes("timeout")||n.includes("offline")?s.NETWORK:n.includes("auth")||n.includes("unauthorized")||n.includes("token")||n.includes("session")?s.AUTH:n.includes("exercise")||n.includes("template")||n.includes("generation")?s.EXERCISE:n.includes("data")||n.includes("load")||n.includes("save")||n.includes("sync")?s.DATA:s.GENERAL}function l(e){const n=e.message.toLowerCase();return n.includes("critical")||n.includes("fatal")||n.includes("crash")?r.CRITICAL:n.includes("auth")||n.includes("unauthorized")||n.includes("data loss")?r.HIGH:n.includes("warning")||n.includes("minor")||n.includes("cosmetic")?r.LOW:r.MEDIUM}function c(e){const n=e.message.toLowerCase();return!!n.includes("resizeobserver")||(!(!n.includes("extension")||!n.includes("script"))||!(!n.includes("failed to fetch")||navigator.onLine))}function u(s={}){if(i)return()=>{};if("undefined"==typeof window)return()=>{};const r={...t,...s},u=s=>function(s,r){const i=s.error||new Error(s.message);if(c(i))return;if(r.shouldHandleError&&!r.shouldHandleError(s))return;if(n(i.message,1e3))return;const a=d(i),u=l(i);if(o({error:i,category:a,severity:u,handled:!1,context:{component:"GlobalErrorHandler",url:window.location.href,filename:s.filename,lineno:s.lineno,colno:s.colno}}),r.showToasts){const n=r.getToastMessage?r.getToastMessage(i):t.getToastMessage(i);e.error(n,7e3)}}(s,r),f=s=>function(s,r){const i=s.reason instanceof Error?s.reason:new Error(String(s.reason));if(c(i))return;if(r.shouldHandleError&&!r.shouldHandleError(i))return;if(n(i.message,1e3))return;const a=d(i),u=l(i);if(o({error:i,category:a,severity:u,handled:!1,context:{component:"GlobalErrorHandler",type:"UnhandledPromiseRejection",url:window.location.href}}),r.showToasts){const n=r.getToastMessage?r.getToastMessage(i):t.getToastMessage(i);e.error(n,7e3)}}(s,r);window.addEventListener("error",u),window.addEventListener("unhandledrejection",f),i=!0;const g=()=>{window.removeEventListener("error",u),window.removeEventListener("unhandledrejection",f),i=!1,a=a.filter(e=>e!==g)};return a.push(g),g}if("loading"===document.readyState)document.addEventListener("DOMContentLoaded",()=>{const e=u({showToast:!0,logToConsole:!1});window.addEventListener("beforeunload",e)});else{const e=u({showToast:!0,logToConsole:!1});window.addEventListener("beforeunload",e)}
