import{d as e,m as t,b as r,C as i,g as a,h as n,i as o,f as s,l,t as d,w as u,n as c,r as g,j as b}from"./solid-core.DXeZPQOr.js";import{$ as h}from"./exercises.qBB0Fcdg.js";import{Q as v}from"./qrcode.C5UO-pJ-.js";var x=d('<div class="text-center py-8"><button type=button class="px-8 py-4 bg-blue-600 text-white font-bold text-lg rounded-lg shadow-lg hover:bg-blue-700 active:bg-blue-800 transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-blue-300 min-w-44px min-h-44px">'),f=d('<div class="text-center py-12"role=status aria-live=polite><div class="inline-block w-12 h-12 border-4 border-blue-200 border-t-blue-600 rounded-full animate-spin"aria-hidden=true></div><div class="mt-4 text-gray-600 font-medium">'),m=d("<div role=region><!$><!/><!$><!/><!$><!/><!$><!/>"),p=d('<svg class="w-6 h-6 text-gray-600"fill=none stroke=currentColor viewBox="0 0 24 24"aria-hidden=true><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">'),y=d('<div class="qr-code-container p-6 bg-white border-2 border-blue-300 rounded-lg shadow-lg animate-fadeIn"role=dialog><div class="flex flex-col items-center gap-4"><div class=text-center><h3 class="text-lg font-bold text-gray-900 mb-2"></h3><p class="text-sm text-gray-600">Scan this QR code with your mobile device</p></div><img class="w-64 h-64 border-4 border-gray-200 rounded-lg shadow-md"width=256 height=256><button type=button class="px-4 py-2 text-sm text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 active:bg-gray-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-gray-400"aria-label="Close QR code">Close'),w=d('<div class="generated-container space-y-6"><div class="warning-banner p-4 bg-orange-100 border-2 border-orange-400 rounded-lg"role=alert><div class="flex items-start gap-3"><svg class="w-6 h-6 text-orange-600 flex-shrink-0 mt-0.5"fill=none stroke=currentColor viewBox="0 0 24 24"aria-hidden=true><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg><div class=flex-1><div class="font-bold text-orange-900 mb-1"></div><div class="text-sm text-orange-800"></div></div></div></div><div class=uuid-display-container><label class="block text-sm font-medium text-gray-700 mb-2"></label><div class="uuid-display p-6 bg-gradient-to-r from-blue-50 to-blue-100 border-2 border-blue-300 rounded-lg shadow-md"><div class="text-center text-3xl md:text-4xl font-mono font-bold text-blue-900 tracking-wider select-all"tabindex=0></div></div></div><div class=save-options><div class="text-sm font-medium text-gray-700 mb-3"></div><div class="grid grid-cols-1 sm:grid-cols-3 gap-3"><button type=button class="save-button flex flex-col items-center justify-center gap-2 p-4 bg-white border-2 border-gray-300 rounded-lg shadow hover:border-blue-400 hover:bg-blue-50 active:bg-blue-100 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-300 min-h-44px"><!$><!/><span class="text-sm font-medium text-gray-900"></span></button><button type=button class="save-button flex flex-col items-center justify-center gap-2 p-4 bg-white border-2 border-gray-300 rounded-lg shadow hover:border-blue-400 hover:bg-blue-50 active:bg-blue-100 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-300 min-h-44px"><svg class="w-6 h-6 text-gray-600"fill=none stroke=currentColor viewBox="0 0 24 24"aria-hidden=true><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg><span class="text-sm font-medium text-gray-900"></span></button><button type=button class="save-button flex flex-col items-center justify-center gap-2 p-4 bg-white border-2 border-gray-300 rounded-lg shadow hover:border-blue-400 hover:bg-blue-50 active:bg-blue-100 transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-blue-300 min-h-44px"><svg class="w-6 h-6 text-gray-600"fill=none stroke=currentColor viewBox="0 0 24 24"aria-hidden=true><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"></path></svg><span class="text-sm font-medium text-gray-900"></span></button></div><div class="mt-3 p-3 bg-gray-50 border border-gray-200 rounded-lg"><div class="flex items-center gap-2 text-sm text-gray-700"><svg class="w-5 h-5 text-gray-500 flex-shrink-0"fill=none stroke=currentColor viewBox="0 0 24 24"aria-hidden=true><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg><span></span></div></div></div><!$><!/>'),C=d('<svg class="w-6 h-6 text-green-600"fill=none stroke=currentColor viewBox="0 0 24 24"aria-hidden=true><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M5 13l4 4L19 7">'),k=d('<div class="error-container text-center py-8"role=alert aria-live=assertive><div class="mb-4 p-4 bg-red-100 border-2 border-red-400 rounded-lg inline-block"><div class="flex items-center gap-3"><svg class="w-8 h-8 text-red-600"fill=none stroke=currentColor viewBox="0 0 24 24"aria-hidden=true><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class=text-left><div class="font-bold text-red-900 mb-1">Error</div><div class="text-sm text-red-800"></div></div></div></div><div><button type=button class="px-6 py-3 bg-blue-600 text-white font-medium rounded-lg shadow hover:bg-blue-700 active:bg-blue-800 transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-blue-300"aria-label="Try again">Try Again');function S(e){const d=t(h),[S,$]=r({status:"idle"}),[j,M]=r(!1),[R,L]=r(!1);i(()=>{e.autoGenerate&&U()});const U=async()=>{$({status:"generating"});try{const t=await fetch("/api/auth/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({gradeRange:e.gradeRange,locale:e.locale})}),r=await t.json();if(!t.ok||!r.success)return void $({status:"error",message:r.error||"Failed to generate UUID"});const i=await v.toDataURL(r.uuid,{width:256,margin:2,color:{dark:"#1a1a1a",light:"#ffffff"}});$({status:"generated",uuid:r.uuid,qrCodeDataUrl:i}),e.onComplete&&e.onComplete(r.uuid)}catch(t){$({status:"error",message:"An unexpected error occurred. Please try again."})}},T=async()=>{const e=S();if("generated"===e.status)try{if(navigator.clipboard&&navigator.clipboard.writeText)return await navigator.clipboard.writeText(e.uuid),M(!0),void setTimeout(()=>M(!1),2e3);const t=document.createElement("textarea");t.value=e.uuid,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select();const r=document.execCommand("copy");document.body.removeChild(t),r&&(M(!0),setTimeout(()=>M(!1),2e3))}catch(t){}},q=()=>{const t=S();if("generated"!==t.status)return;const r=`${d()("auth.uuid.yourNumber")}\n\n${t.uuid}\n\n${d()("auth.uuid.important")}\n\n${d()("auth.uuid.description")}\n\n---\nGenerated: ${(new Date).toLocaleString(e.locale)}\nGrade Range: ${e.gradeRange}\n`,i=new Blob([r],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(i),n=document.createElement("a"),o=(new Date).toISOString().split("T")[0];n.href=a,n.download=`practice-number-${o}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)};return(()=>{var t=a(m),r=t.firstChild,[i,h]=n(r.nextSibling),v=i.nextSibling,[$,M]=n(v.nextSibling),z=$.nextSibling,[B,D]=n(z.nextSibling),H=B.nextSibling,[O,V]=n(H.nextSibling);return o(t,s(b,{get when(){return"idle"===S().status},get children(){var e=a(x),t=e.firstChild;return t.$$click=U,o(t,()=>d()("auth.uuid.generate")),l(()=>c(t,"aria-label",d()("auth.uuid.generate"))),g(),e}}),i,h),o(t,s(b,{get when(){return"generating"===S().status},get children(){var e=a(f),t=e.firstChild.nextSibling;return o(t,()=>d()("common.status.loading")),e}}),$,M),o(t,s(b,{get when(){return"generated"===S().status},children:e=>{const t=S();return"generated"!==t.status?null:(()=>{var e=a(w),r=e.firstChild,i=r.firstChild.firstChild.nextSibling.firstChild,u=i.nextSibling,h=r.nextSibling,v=h.firstChild,x=v.nextSibling.firstChild,f=h.nextSibling,m=f.firstChild,k=m.nextSibling,S=k.firstChild,$=S.firstChild,[M,U]=n($.nextSibling),z=M.nextSibling,B=S.nextSibling,D=B.firstChild.nextSibling,H=B.nextSibling,O=H.firstChild.nextSibling,V=k.nextSibling.firstChild.firstChild.nextSibling,I=f.nextSibling,[N,Q]=n(I.nextSibling);return o(i,()=>d()("auth.uuid.save.title")),o(u,()=>d()("auth.uuid.important")),o(v,()=>d()("auth.uuid.yourNumber")),o(x,()=>t.uuid),o(m,()=>d()("auth.uuid.save.instructions")),S.$$click=T,o(S,s(b,{get when(){return!j()},get fallback(){return a(C)},get children(){return a(p)}}),M,U),o(z,s(b,{get when(){return j()},get fallback(){return d()("auth.uuid.save.copy")},get children(){return d()("auth.uuid.copied")}})),B.$$click=q,o(D,()=>d()("auth.uuid.save.download")),H.$$click=()=>L(!R()),o(O,()=>d()("auth.uuid.save.qrCode")),o(V,()=>d()("auth.uuid.save.writeDown")),o(e,s(b,{get when(){return R()},get children(){var e=a(y),r=e.firstChild.firstChild,i=r.firstChild,n=r.nextSibling,s=n.nextSibling;return o(i,()=>d()("auth.uuid.save.qrCode")),s.$$click=()=>L(!1),l(r=>{var i=d()("auth.uuid.save.qrCode"),a=t.qrCodeDataUrl,o=`QR code for practice number ${t.uuid}`;return i!==r.e&&c(e,"aria-label",r.e=i),a!==r.t&&c(n,"src",r.t=a),o!==r.a&&c(n,"alt",r.a=o),r},{e:void 0,t:void 0,a:void 0}),g(),e}}),N,Q),l(e=>{var r=`${d()("auth.uuid.yourNumber")} ${t.uuid}`,i=d()("auth.uuid.save.copy"),a=d()("auth.uuid.save.download"),n=d()("auth.uuid.save.qrCode"),o=R();return r!==e.e&&c(x,"aria-label",e.e=r),i!==e.t&&c(S,"aria-label",e.t=i),a!==e.a&&c(B,"aria-label",e.a=a),n!==e.o&&c(H,"aria-label",e.o=n),o!==e.i&&c(H,"aria-expanded",e.i=o),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),g(),e})()}}),B,D),o(t,s(b,{get when(){return"error"===S().status},children:e=>{const t=S();return"error"!==t.status?null:(r=a(k),i=r.firstChild,n=i.firstChild.firstChild.nextSibling.firstChild.nextSibling,s=i.nextSibling.firstChild,o(n,()=>t.message),s.$$click=U,g(),r);var r,i,n,s}}),O,V),l(r=>{var i=`uuid-generator ${e.class||""}`,a=d()("auth.uuid.title");return i!==r.e&&u(t,r.e=i),a!==r.t&&c(t,"aria-label",r.t=a),r},{e:void 0,t:void 0}),t})()}e(["click"]);export{S as U};
