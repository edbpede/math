import{d as W,c as b,o as X,g as x,a as $,i as u,b as E,e as N,t as p,f as L,j as Y,S as T,m as O,h as Z,s as k,r as ee}from"./store.D7pQqe3Y.js";import{m as te,$ as ne}from"./store.BH8NtN2R.js";var ie=p('<span class="absolute inset-0 w-2 h-2 rounded-full bg-blue-600 animate-ping opacity-75"aria-hidden=true>'),oe=p('<span class="text-sm text-gray-600 hidden sm:inline"><!$><!/> <!$><!/>'),se=p('<button type=button class="btn-ghost text-xs touch-target"><svg fill=none viewBox="0 0 24 24"stroke=currentColor aria-hidden=true><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15">'),ae=p('<div role=status aria-live=polite aria-atomic=true><div class="flex items-center gap-2"><div class=relative><span aria-hidden=true></span><!$><!/></div><span></span></div><!$><!/><!$><!/>');function ce(M){const l=te(ne),[f,R]=b(!0),[s,w]=b(!1),[I,_]=b(null),[j,A]=b(""),g=()=>{typeof navigator<"u"&&R(navigator.onLine)},B=t=>{const a=new Date().getTime()-t.getTime(),i=Math.floor(a/1e3),r=Math.floor(i/60),v=Math.floor(r/60),C=Math.floor(v/24),o=l();return i<60?o("common.time.justNow"):r<60?`${r} ${o("common.time.minutes")} ${o("common.time.ago")}`:v<24?`${v} ${o("common.time.hours")} ${o("common.time.ago")}`:`${C} ${o("common.time.days")} ${o("common.time.ago")}`},D=()=>{const t=I();t&&A(B(t))},P=async()=>{if(!(s()||!f())){w(!0);try{await new Promise(t=>setTimeout(t,1e3)),_(new Date)}catch(t){console.error("Sync failed:",t)}finally{w(!1)}}};X(()=>{if(typeof window>"u")return;if(g(),window.addEventListener("online",g),window.addEventListener("offline",g),typeof localStorage<"u"){const i=localStorage.getItem("lastSyncTimestamp");i&&_(new Date(i))}const t=setInterval(D,3e4);D();const m=()=>w(!0),a=i=>{w(!1);const r=new Date(i.detail.timestamp||Date.now());_(r),typeof localStorage<"u"&&localStorage.setItem("lastSyncTimestamp",r.toISOString())};window.addEventListener("sync:start",m),window.addEventListener("sync:complete",a),Y(()=>{typeof window<"u"&&(window.removeEventListener("online",g),window.removeEventListener("offline",g),window.removeEventListener("sync:start",m),window.removeEventListener("sync:complete",a)),clearInterval(t)})});const q=()=>s()?l()("common.status.syncing"):f()?l()("common.status.online"):l()("common.status.offline"),z=()=>s()?"text-blue-600":f()?"text-green-600":"text-gray-500",F=()=>s()?"bg-blue-600":f()?"bg-green-600":"bg-gray-400";return(()=>{var t=x(ae),m=t.firstChild,a=m.firstChild,i=a.firstChild,r=i.nextSibling,[v,C]=$(r.nextSibling),o=a.nextSibling,G=m.nextSibling,[H,J]=$(G.nextSibling),K=H.nextSibling,[Q,U]=$(K.nextSibling);return u(a,E(T,{get when(){return s()},get children(){return x(ie)}}),v,C),u(o,q),u(t,E(T,{get when(){return O(()=>!!I())()&&!s()},get children(){var e=x(oe),d=e.firstChild,[n,c]=$(d.nextSibling),y=n.nextSibling,S=y.nextSibling,[h,V]=$(S.nextSibling);return u(e,()=>l()("common.status.synced"),n,c),u(e,j,h,V),e}}),H,J),u(t,E(T,{get when(){return O(()=>!!M.showSyncButton)()&&f()},get children(){var e=x(se),d=e.firstChild;return e.$$click=P,N(n=>{var c=s(),y=l()("common.status.syncing"),S=l()("common.status.syncing"),h=`w-4 h-4 ${s()?"animate-spin":""}`;return c!==n.e&&Z(e,"disabled",n.e=c),y!==n.t&&k(e,"aria-label",n.t=y),S!==n.a&&k(e,"title",n.a=S),h!==n.o&&k(d,"class",n.o=h),n},{e:void 0,t:void 0,a:void 0,o:void 0}),ee(),e}}),Q,U),N(e=>{var d=`sync-status flex items-center gap-3 ${M.class||""}`,n=`inline-block w-2 h-2 rounded-full ${F()}`,c=`text-sm font-medium ${z()}`;return d!==e.e&&L(t,e.e=d),n!==e.t&&L(i,e.t=n),c!==e.a&&L(o,e.a=c),e},{e:void 0,t:void 0,a:void 0}),t})()}W(["click"]);export{ce as default};
