import{d as ue,c as p,o as de,j as ge,g as l,a as u,i as n,b as d,e as _,r as T,t as i,s as A,f as B,k as be,S as g,m as ye,h as $e}from"./store.C-Iyz76Y.js";import{m as v,$ as xe}from"./store.BEcAnxVL.js";import{$ as fe,a as me,b as Se,g as F,i as he,t as pe}from"./network-status.I15yulLv.js";import"./progress.isgvytKC.js";import"./client.D0X2hLWc.js";import"./_commonjsHelpers.gnU0ypJ3.js";var ve=i('<span class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs font-semibold px-2 py-0.5 rounded-full">'),_e=i('<div class="mb-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm"><span class="text-blue-800 dark:text-blue-200">'),we=i('<div class="mb-3 p-2 bg-red-50 dark:bg-red-900/20 rounded text-sm text-red-800 dark:text-red-200">'),ke=i('<span class="flex items-center justify-center gap-2"><svg class="animate-spin h-4 w-4"viewBox="0 0 24 24"><circle class=opacity-25 cx=12 cy=12 r=10 stroke=currentColor stroke-width=4 fill=none></circle><path class=opacity-75 fill=currentColor d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><!$><!/>'),Ce=i('<button type=button class="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-medium py-2 px-4 rounded transition-colors">'),Ie=i('<div class="text-sm text-center text-gray-500 dark:text-gray-400 py-2">'),Me=i('<div class="absolute bottom-full right-0 mb-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 p-4"><div class="flex items-center justify-between mb-3 pb-3 border-b border-gray-200 dark:border-gray-700"><h3 class="font-semibold text-gray-900 dark:text-white"></h3></div><div class=mb-3><div class="flex items-center gap-2 mb-1"><div></div><span class="text-sm text-gray-600 dark:text-gray-400"></span></div></div><!$><!/><div class="mb-3 text-sm text-gray-600 dark:text-gray-400"></div><!$><!/><!$><!/><!$><!/>'),qe=i('<div class="fixed bottom-4 right-4 z-50"><button type=button class="flex items-center gap-2 bg-white dark:bg-gray-800 rounded-lg shadow-lg px-3 py-2 transition-all hover:shadow-xl"aria-label="Sync status"><div></div><span class="text-sm font-medium text-gray-700 dark:text-gray-300"></span><!$><!/><svg fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M19 9l-7 7-7-7"></path></svg></button><!$><!/>');function Be(){const[f,H]=p(!1),[b,w]=p(!1),[m,S]=p(null),[P,k]=p("Never"),r=v(xe),o=v(fe),e=v(me);v(Se),de(async()=>{try{await he()}catch(c){console.error("[SyncStatusIndicator] Failed to initialize:",c),S("Initialization failed")}const a=setInterval(()=>{k(F())},1e4);be(()=>clearInterval(a))}),ge(()=>{e()&&k(F())});const L=async()=>{if(!o().online){S(r()("sync.errors.cannotSyncOffline"));return}w(!0),S(null);try{const a=await pe();console.log(`[SyncStatusIndicator] Manual sync completed: ${a} items`)}catch(a){console.error("[SyncStatusIndicator] Manual sync failed:",a),S(a instanceof Error?a.message:r()("sync.errors.syncFailed"))}finally{w(!1)}},O=()=>o().online?e().syncing||b()?"bg-yellow-500":e().error||m()?"bg-orange-500":e().queueCount>0?"bg-blue-500":"bg-green-500":"bg-red-500",R=()=>o().online?e().syncing||b()?r()("sync.status.syncing"):e().error||m()?r()("sync.status.error"):e().queueCount>0?r()("sync.status.pending"):r()("sync.status.online"):r()("sync.status.offline");return(()=>{var a=l(qe),c=a.firstChild,C=c.firstChild,I=C.nextSibling,V=I.nextSibling,[M,D]=u(V.nextSibling),G=M.nextSibling,J=c.nextSibling,[K,Q]=u(J.nextSibling);return c.$$click=()=>H(!f()),n(I,R),n(c,d(g,{get when(){return e().queueCount>0},get children(){var t=l(ve);return n(t,()=>e().queueCount),t}}),M,D),n(a,d(g,{get when(){return f()},get children(){var t=l(Me),y=t.firstChild,h=y.firstChild,$=y.nextSibling,U=$.firstChild,q=U.firstChild,W=q.nextSibling,X=$.nextSibling,[E,Y]=u(X.nextSibling),z=E.nextSibling,Z=z.nextSibling,[j,ee]=u(Z.nextSibling),te=j.nextSibling,[N,ne]=u(te.nextSibling),re=N.nextSibling,[se,ae]=u(re.nextSibling);return n(h,()=>r()("sync.settings.title")),n(W,(()=>{var s=ye(()=>!!o().online);return()=>s()?r()("sync.status.online"):r()("sync.status.offline")})()),n(t,d(g,{get when(){return e().queueCount>0},get children(){var s=l(_e),x=s.firstChild;return n(x,()=>r()("sync.ui.queueCount",{count:e().queueCount})),s}}),E,Y),n(z,()=>r()("sync.ui.lastSync",{time:P()})),n(t,d(g,{get when(){return e().error||m()},get children(){var s=l(we);return n(s,()=>e().error||m()),s}}),j,ee),n(t,d(g,{get when(){return o().online},get children(){var s=l(Ce);return s.$$click=L,n(s,d(g,{get when(){return e().syncing||b()},get fallback(){return r()("sync.ui.manualSync")},get children(){var x=l(ke),le=x.firstChild,ie=le.nextSibling,[oe,ce]=u(ie.nextSibling);return n(x,()=>r()("sync.ui.syncInProgress"),oe,ce),x}})),_(()=>$e(s,"disabled",e().syncing||b()||e().queueCount===0)),T(),s}}),N,ne),n(t,d(g,{get when(){return!o().online},get children(){var s=l(Ie);return n(s,()=>r()("sync.messages.offlineMode")),s}}),se,ae),_(()=>B(q,`w-2 h-2 rounded-full ${o().online?"bg-green-500":"bg-red-500"}`)),t}}),K,Q),_(t=>{var y=f(),h=`w-3 h-3 rounded-full ${O()} ${e().syncing||b()?"animate-pulse":""}`,$=`w-4 h-4 transition-transform ${f()?"rotate-180":""}`;return y!==t.e&&A(c,"aria-expanded",t.e=y),h!==t.t&&B(C,t.t=h),$!==t.a&&A(G,"class",t.a=$),t},{e:void 0,t:void 0,a:void 0}),T(),a})()}ue(["click"]);export{Be as default};
