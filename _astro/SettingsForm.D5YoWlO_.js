import{d as Ke,c as N,g,a as x,i as s,b,e as c,t as v,f as z,h as K,S as w,F as U,s as ie,r as re}from"./store.C-Iyz76Y.js";import{b as Re,m as ae,$ as Te}from"./store.BEcAnxVL.js";import{u as Pe}from"./service.DU7FcLOF.js";import"./client.D0X2hLWc.js";import"./_commonjsHelpers.gnU0ypJ3.js";const k={theme:"light",fontSize:"medium",dyslexiaFont:!1,highContrast:!1};function Be(e={}){return{theme:e.theme||k.theme,fontSize:e.fontSize||k.fontSize,dyslexiaFont:e.dyslexiaFont!==void 0?!!e.dyslexiaFont:k.dyslexiaFont,highContrast:e.highContrast!==void 0?!!e.highContrast:k.highContrast}}function Ge(e){return e==="light"||e==="dark"||e==="system"}function Me(e){return e==="small"||e==="medium"||e==="large"}function Ne(e){return!(e.theme!==void 0&&!Ge(e.theme)||e.fontSize!==void 0&&!Me(e.fontSize)||e.dyslexiaFont!==void 0&&typeof e.dyslexiaFont!="boolean"||e.highContrast!==void 0&&typeof e.highContrast!="boolean")}const O=Re(k);function p(e){const l=O.get(),a=Be({...l,...e});O.set(a)}var Ue=v('<div class="flex items-center gap-2"><div class="h-4 w-4 animate-spin rounded-full border-2 border-blue-800 border-t-transparent"></div><span>'),Oe=v('<div class="flex items-center gap-2"><svg class="h-5 w-5"fill=currentColor viewBox="0 0 20 20"><path fill-rule=evenodd d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"clip-rule=evenodd></path></svg><span>'),De=v('<div class="flex items-center gap-2"><svg class="h-5 w-5"fill=currentColor viewBox="0 0 20 20"><path fill-rule=evenodd d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"clip-rule=evenodd></path></svg><span>'),Ae=v("<div role=status aria-live=polite><!$><!/><!$><!/><!$><!/>"),He=v('<div class="text-sm text-gray-600"role=status aria-live=polite>'),Ve=v('<div><!$><!/><section class=mb-8><h3 class="mb-2 text-lg font-semibold text-gray-900"></h3><p class="mb-4 text-sm text-gray-600"></p><fieldset class=space-y-3><legend class=sr-only></legend><!$><!/></fieldset></section><section class=mb-8><h3 class="mb-2 text-lg font-semibold text-gray-900"></h3><p class="mb-4 text-sm text-gray-600"></p><div class=space-y-6><div><label class="mb-2 block text-sm font-medium text-gray-700"></label><p class="mb-3 text-sm text-gray-600"></p><div class="grid grid-cols-3 gap-3"></div></div><div><label class="mb-2 block text-sm font-medium text-gray-700"></label><p class="mb-3 text-sm text-gray-600"></p><div class="grid grid-cols-3 gap-3"></div></div><div class="flex items-start gap-4 rounded-lg border border-gray-200 p-4"><input type=checkbox id=dyslexia-font class="mt-1 h-5 w-5 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"><div class=flex-1><label for=dyslexia-font class="block cursor-pointer font-medium text-gray-900"></label><p class="mt-1 text-sm text-gray-600"></p></div></div><div class="flex items-start gap-4 rounded-lg border border-gray-200 p-4"><input type=checkbox id=high-contrast class="mt-1 h-5 w-5 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"><div class=flex-1><label for=high-contrast class="block cursor-pointer font-medium text-gray-900"></label><p class="mt-1 text-sm text-gray-600"></p></div></div></div></section><!$><!/>'),Ie=v('<label><input type=radio name=gradeRange class="mt-1 h-5 w-5 cursor-pointer text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"><div class=flex-1><div class="font-medium text-gray-900"></div><div class="text-sm text-gray-600">'),ne=v("<button type=button>");let y=null;const We=1e3;function Ye(e){const l=ae(Te),a=ae(O),[R,T]=N(e.initialGradeRange),[m,h]=N({status:"idle"}),[oe,D]=N(!1);let P=e.initialGradeRange,B=a();const de=async()=>{y&&(clearTimeout(y),y=null),h({status:"saving"}),D(!1);const o=a();if(!Ne(o)){h({status:"error",message:l()("settings.messages.saveError")});return}const E=R(),L=o;try{const f=await Pe(e.userId,{gradeRange:E,preferences:o});if(!f.success){T(P),p(B),h({status:"error",message:f.error||l()("settings.messages.saveError")});return}P=E,B=L,h({status:"saved"}),setTimeout(()=>{h(_=>_.status==="saved"?{status:"idle"}:_)},3e3)}catch(f){console.error("Error saving settings:",f),T(P),p(B),h({status:"error",message:l()("settings.messages.saveError")})}},$=()=>{D(!0),y&&clearTimeout(y),y=setTimeout(()=>{de()},We)},ge=[{value:"0-3",labelKey:"settings.gradeLevel.options.0-3.label",descKey:"settings.gradeLevel.options.0-3.description"},{value:"4-6",labelKey:"settings.gradeLevel.options.4-6.label",descKey:"settings.gradeLevel.options.4-6.description"},{value:"7-9",labelKey:"settings.gradeLevel.options.7-9.label",descKey:"settings.gradeLevel.options.7-9.description"}],ce=[{value:"light",labelKey:"settings.display.theme.options.light"},{value:"dark",labelKey:"settings.display.theme.options.dark"},{value:"system",labelKey:"settings.display.theme.options.system"}],ue=[{value:"small",labelKey:"settings.display.fontSize.options.small"},{value:"medium",labelKey:"settings.display.fontSize.options.medium"},{value:"large",labelKey:"settings.display.fontSize.options.large"}];return(()=>{var o=g(Ve),E=o.firstChild,[L,f]=x(E.nextSibling),_=L.nextSibling,A=_.firstChild,H=A.nextSibling,V=H.nextSibling,I=V.firstChild,be=I.nextSibling,[ve,me]=x(be.nextSibling),W=_.nextSibling,j=W.firstChild,q=j.nextSibling,he=q.nextSibling,J=he.firstChild,Q=J.firstChild,X=Q.nextSibling,fe=X.nextSibling,Y=J.nextSibling,Z=Y.firstChild,ee=Z.nextSibling,xe=ee.nextSibling,te=Y.nextSibling,G=te.firstChild,pe=G.nextSibling,se=pe.firstChild,ye=se.nextSibling,$e=te.nextSibling,M=$e.firstChild,_e=M.nextSibling,le=_e.firstChild,Se=le.nextSibling,Ce=W.nextSibling,[ze,we]=x(Ce.nextSibling);return s(o,b(w,{get when(){return m().status!=="idle"},get children(){var t=g(Ae),r=t.firstChild,[i,d]=x(r.nextSibling),n=i.nextSibling,[F,ke]=x(n.nextSibling),Ee=F.nextSibling,[Le,Fe]=x(Ee.nextSibling);return s(t,b(w,{get when(){return m().status==="saving"},get children(){var u=g(Ue),S=u.firstChild,C=S.nextSibling;return s(C,()=>l()("settings.display.autoSave")),u}}),i,d),s(t,b(w,{get when(){return m().status==="saved"},get children(){var u=g(Oe),S=u.firstChild,C=S.nextSibling;return s(C,()=>l()("settings.display.saved")),u}}),F,ke),s(t,b(w,{get when(){return m().status==="error"},get children(){var u=g(De),S=u.firstChild,C=S.nextSibling;return s(C,()=>m().message),u}}),Le,Fe),c(()=>z(t,`
            mb-6 rounded-lg border p-4
            ${m().status==="saving"?"border-blue-300 bg-blue-50 text-blue-800":m().status==="saved"?"border-green-300 bg-green-50 text-green-800":"border-red-300 bg-red-50 text-red-800"}
          `)),t}}),L,f),s(A,()=>l()("settings.sections.gradeLevel.title")),s(H,()=>l()("settings.sections.gradeLevel.description")),s(I,()=>l()("settings.gradeLevel.label")),s(V,b(U,{each:ge,children:t=>(()=>{var r=g(Ie),i=r.firstChild,d=i.nextSibling,n=d.firstChild,F=n.nextSibling;return i.addEventListener("change",()=>{T(t.value),$()}),s(n,()=>l()(t.labelKey)),s(F,()=>l()(t.descKey)),c(()=>z(r,`
                  flex cursor-pointer items-start gap-3 rounded-lg border-2 p-4
                  transition-all duration-200
                  ${R()===t.value?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300"}
                `)),c(()=>K(i,"value",t.value)),c(()=>K(i,"checked",R()===t.value)),r})()}),ve,me),s(j,()=>l()("settings.sections.display.title")),s(q,()=>l()("settings.sections.display.description")),s(Q,()=>l()("settings.display.theme.label")),s(X,()=>l()("settings.display.theme.description")),s(fe,b(U,{each:ce,children:t=>(()=>{var r=g(ne);return r.$$click=()=>{p({theme:t.value}),$()},s(r,()=>l()(t.labelKey)),c(i=>{var d=`
                      rounded-lg border-2 px-4 py-3 text-sm font-medium
                      transition-all duration-200
                      focus:outline-none focus:ring-4 focus:ring-blue-300
                      ${a().theme===t.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-blue-300"}
                    `,n=a().theme===t.value;return d!==i.e&&z(r,i.e=d),n!==i.t&&ie(r,"aria-pressed",i.t=n),i},{e:void 0,t:void 0}),re(),r})()})),s(Z,()=>l()("settings.display.fontSize.label")),s(ee,()=>l()("settings.display.fontSize.description")),s(xe,b(U,{each:ue,children:t=>(()=>{var r=g(ne);return r.$$click=()=>{p({fontSize:t.value}),$()},s(r,()=>l()(t.labelKey)),c(i=>{var d=`
                      rounded-lg border-2 px-4 py-3 text-sm font-medium
                      transition-all duration-200
                      focus:outline-none focus:ring-4 focus:ring-blue-300
                      ${a().fontSize===t.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-blue-300"}
                    `,n=a().fontSize===t.value;return d!==i.e&&z(r,i.e=d),n!==i.t&&ie(r,"aria-pressed",i.t=n),i},{e:void 0,t:void 0}),re(),r})()})),G.addEventListener("change",t=>{p({dyslexiaFont:t.currentTarget.checked}),$()}),s(se,()=>l()("settings.display.dyslexiaFont.label")),s(ye,()=>l()("settings.display.dyslexiaFont.description")),M.addEventListener("change",t=>{p({highContrast:t.currentTarget.checked}),$()}),s(le,()=>l()("settings.display.highContrast.label")),s(Se,()=>l()("settings.display.highContrast.description")),s(o,b(w,{get when(){return oe()},get children(){var t=g(He);return s(t,()=>l()("settings.display.autoSave")),t}}),ze,we),c(()=>z(o,`settings-form ${e.class||""}`)),c(()=>K(G,"checked",a().dyslexiaFont)),c(()=>K(M,"checked",a().highContrast)),o})()}Ke(["click"]);export{Ye as default};
