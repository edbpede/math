import{d as De,c as f,k as Ge,g as c,a as $,i as s,b as h,e as u,t as m,f as F,h as T,S as k,F as W,s as ce,r as ue}from"./store.D7pQqe3Y.js";import{m as Ne,$ as Oe}from"./store.CLE7GteW.js";import{u as Ue}from"./service.DU7FcLOF.js";import"./client.D0X2hLWc.js";import"./_commonjsHelpers.gnU0ypJ3.js";const P={theme:"light",fontSize:"medium",dyslexiaFont:!1,highContrast:!1};function He(t={}){return{theme:t.theme||P.theme,fontSize:t.fontSize||P.fontSize,dyslexiaFont:t.dyslexiaFont!==void 0?!!t.dyslexiaFont:P.dyslexiaFont,highContrast:t.highContrast!==void 0?!!t.highContrast:P.highContrast}}function Ae(t){return t==="light"||t==="dark"||t==="system"}function Ve(t){return t==="small"||t==="medium"||t==="large"}function Ie(t){return!(t.theme!==void 0&&!Ae(t.theme)||t.fontSize!==void 0&&!Ve(t.fontSize)||t.dyslexiaFont!==void 0&&typeof t.dyslexiaFont!="boolean"||t.highContrast!==void 0&&typeof t.highContrast!="boolean")}var We=m('<div class="flex items-center gap-2"><div class="h-4 w-4 animate-spin rounded-full border-2 border-blue-800 border-t-transparent"></div><span>'),je=m('<div class="flex items-center gap-2"><svg class="h-5 w-5"fill=currentColor viewBox="0 0 20 20"><path fill-rule=evenodd d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"clip-rule=evenodd></path></svg><span>'),qe=m('<div class="flex items-center gap-2"><svg class="h-5 w-5"fill=currentColor viewBox="0 0 20 20"><path fill-rule=evenodd d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"clip-rule=evenodd></path></svg><span>'),Je=m("<div role=status aria-live=polite><!$><!/><!$><!/><!$><!/>"),Qe=m('<div class="text-sm text-gray-600"role=status aria-live=polite>'),Xe=m('<div><!$><!/><section class=mb-8><h3 class="mb-2 text-lg font-semibold text-gray-900"></h3><p class="mb-4 text-sm text-gray-600"></p><fieldset class=space-y-3><legend class=sr-only></legend><!$><!/></fieldset></section><section class=mb-8><h3 class="mb-2 text-lg font-semibold text-gray-900"></h3><p class="mb-4 text-sm text-gray-600"></p><div class=space-y-6><div><label class="mb-2 block text-sm font-medium text-gray-700"></label><p class="mb-3 text-sm text-gray-600"></p><div class="grid grid-cols-3 gap-3"></div></div><div><label class="mb-2 block text-sm font-medium text-gray-700"></label><p class="mb-3 text-sm text-gray-600"></p><div class="grid grid-cols-3 gap-3"></div></div><div class="flex items-start gap-4 rounded-lg border border-gray-200 p-4"><input type=checkbox id=dyslexia-font class="mt-1 h-5 w-5 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"><div class=flex-1><label for=dyslexia-font class="block cursor-pointer font-medium text-gray-900"></label><p class="mt-1 text-sm text-gray-600"></p></div></div><div class="flex items-start gap-4 rounded-lg border border-gray-200 p-4"><input type=checkbox id=high-contrast class="mt-1 h-5 w-5 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"><div class=flex-1><label for=high-contrast class="block cursor-pointer font-medium text-gray-900"></label><p class="mt-1 text-sm text-gray-600"></p></div></div></div></section><!$><!/>'),Ye=m('<label><input type=radio name=gradeRange class="mt-1 h-5 w-5 cursor-pointer text-blue-600 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"><div class=flex-1><div class="font-medium text-gray-900"></div><div class="text-sm text-gray-600">'),be=m("<button type=button>");let p=null;const Ze=1e3;function at(t){const i=Ne(Oe),_=He(t.initialPreferences),[M,B]=f(t.initialGradeRange),[E,D]=f(_.theme),[w,G]=f(_.fontSize),[N,O]=f(_.dyslexiaFont),[U,H]=f(_.highContrast),[v,x]=f({status:"idle"}),[he,j]=f(!1);let A=t.initialGradeRange,d=_;const me=async()=>{p&&(clearTimeout(p),p=null),x({status:"saving"}),j(!1);const a={theme:E(),fontSize:w(),dyslexiaFont:N(),highContrast:U()};if(!Ie(a)){x({status:"error",message:i()("settings.messages.saveError")});return}const r=M(),K=a;try{const y=await Ue(t.userId,{gradeRange:r,preferences:a});if(!y.success){B(A),D(d.theme),G(d.fontSize),O(d.dyslexiaFont),H(d.highContrast),x({status:"error",message:y.error||i()("settings.messages.saveError")});return}A=r,d=K,x({status:"saved"}),setTimeout(()=>{x(C=>C.status==="saved"?{status:"idle"}:C)},3e3),q(a)}catch(y){console.error("Error saving settings:",y),B(A),D(d.theme),G(d.fontSize),O(d.dyslexiaFont),H(d.highContrast),x({status:"error",message:i()("settings.messages.saveError")})}},S=()=>{j(!0),p&&clearTimeout(p),p=setTimeout(()=>{me()},Ze)},q=a=>{const r=document.documentElement;a.theme==="dark"?r.classList.add("dark-theme"):a.theme==="light"&&r.classList.remove("dark-theme"),r.classList.remove("font-small","font-medium","font-large"),a.fontSize&&r.classList.add(`font-${a.fontSize}`),a.dyslexiaFont?r.classList.add("dyslexia-font"):r.classList.remove("dyslexia-font"),a.highContrast?r.classList.add("high-contrast"):r.classList.remove("high-contrast")};Ge(()=>{q({theme:E(),fontSize:w(),dyslexiaFont:N(),highContrast:U()})});const ve=[{value:"0-3",labelKey:"settings.gradeLevel.options.0-3.label",descKey:"settings.gradeLevel.options.0-3.description"},{value:"4-6",labelKey:"settings.gradeLevel.options.4-6.label",descKey:"settings.gradeLevel.options.4-6.description"},{value:"7-9",labelKey:"settings.gradeLevel.options.7-9.label",descKey:"settings.gradeLevel.options.7-9.description"}],fe=[{value:"light",labelKey:"settings.display.theme.options.light"},{value:"dark",labelKey:"settings.display.theme.options.dark"},{value:"system",labelKey:"settings.display.theme.options.system"}],xe=[{value:"small",labelKey:"settings.display.fontSize.options.small"},{value:"medium",labelKey:"settings.display.fontSize.options.medium"},{value:"large",labelKey:"settings.display.fontSize.options.large"}];return(()=>{var a=c(Xe),r=a.firstChild,[K,y]=$(r.nextSibling),C=K.nextSibling,J=C.firstChild,Q=J.nextSibling,X=Q.nextSibling,Y=X.firstChild,ye=Y.nextSibling,[$e,pe]=$(ye.nextSibling),Z=C.nextSibling,ee=Z.firstChild,te=ee.nextSibling,_e=te.nextSibling,se=_e.firstChild,ie=se.firstChild,le=ie.nextSibling,Se=le.nextSibling,ae=se.nextSibling,ne=ae.firstChild,re=ne.nextSibling,Ce=re.nextSibling,oe=ae.nextSibling,V=oe.firstChild,ze=V.nextSibling,de=ze.firstChild,Le=de.nextSibling,Fe=oe.nextSibling,I=Fe.firstChild,ke=I.nextSibling,ge=ke.firstChild,Ee=ge.nextSibling,we=Z.nextSibling,[Ke,Re]=$(we.nextSibling);return s(a,h(k,{get when(){return v().status!=="idle"},get children(){var e=c(Je),n=e.firstChild,[l,g]=$(n.nextSibling),o=l.nextSibling,[R,Te]=$(o.nextSibling),Pe=R.nextSibling,[Me,Be]=$(Pe.nextSibling);return s(e,h(k,{get when(){return v().status==="saving"},get children(){var b=c(We),z=b.firstChild,L=z.nextSibling;return s(L,()=>i()("settings.display.autoSave")),b}}),l,g),s(e,h(k,{get when(){return v().status==="saved"},get children(){var b=c(je),z=b.firstChild,L=z.nextSibling;return s(L,()=>i()("settings.display.saved")),b}}),R,Te),s(e,h(k,{get when(){return v().status==="error"},get children(){var b=c(qe),z=b.firstChild,L=z.nextSibling;return s(L,()=>v().message),b}}),Me,Be),u(()=>F(e,`
            mb-6 rounded-lg border p-4
            ${v().status==="saving"?"border-blue-300 bg-blue-50 text-blue-800":v().status==="saved"?"border-green-300 bg-green-50 text-green-800":"border-red-300 bg-red-50 text-red-800"}
          `)),e}}),K,y),s(J,()=>i()("settings.sections.gradeLevel.title")),s(Q,()=>i()("settings.sections.gradeLevel.description")),s(Y,()=>i()("settings.gradeLevel.label")),s(X,h(W,{each:ve,children:e=>(()=>{var n=c(Ye),l=n.firstChild,g=l.nextSibling,o=g.firstChild,R=o.nextSibling;return l.addEventListener("change",()=>{B(e.value),S()}),s(o,()=>i()(e.labelKey)),s(R,()=>i()(e.descKey)),u(()=>F(n,`
                  flex cursor-pointer items-start gap-3 rounded-lg border-2 p-4
                  transition-all duration-200
                  ${M()===e.value?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300"}
                `)),u(()=>T(l,"value",e.value)),u(()=>T(l,"checked",M()===e.value)),n})()}),$e,pe),s(ee,()=>i()("settings.sections.display.title")),s(te,()=>i()("settings.sections.display.description")),s(ie,()=>i()("settings.display.theme.label")),s(le,()=>i()("settings.display.theme.description")),s(Se,h(W,{each:fe,children:e=>(()=>{var n=c(be);return n.$$click=()=>{D(e.value),S()},s(n,()=>i()(e.labelKey)),u(l=>{var g=`
                      rounded-lg border-2 px-4 py-3 text-sm font-medium
                      transition-all duration-200
                      focus:outline-none focus:ring-4 focus:ring-blue-300
                      ${E()===e.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-blue-300"}
                    `,o=E()===e.value;return g!==l.e&&F(n,l.e=g),o!==l.t&&ce(n,"aria-pressed",l.t=o),l},{e:void 0,t:void 0}),ue(),n})()})),s(ne,()=>i()("settings.display.fontSize.label")),s(re,()=>i()("settings.display.fontSize.description")),s(Ce,h(W,{each:xe,children:e=>(()=>{var n=c(be);return n.$$click=()=>{G(e.value),S()},s(n,()=>i()(e.labelKey)),u(l=>{var g=`
                      rounded-lg border-2 px-4 py-3 text-sm font-medium
                      transition-all duration-200
                      focus:outline-none focus:ring-4 focus:ring-blue-300
                      ${w()===e.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white text-gray-700 hover:border-blue-300"}
                    `,o=w()===e.value;return g!==l.e&&F(n,l.e=g),o!==l.t&&ce(n,"aria-pressed",l.t=o),l},{e:void 0,t:void 0}),ue(),n})()})),V.addEventListener("change",e=>{O(e.currentTarget.checked),S()}),s(de,()=>i()("settings.display.dyslexiaFont.label")),s(Le,()=>i()("settings.display.dyslexiaFont.description")),I.addEventListener("change",e=>{H(e.currentTarget.checked),S()}),s(ge,()=>i()("settings.display.highContrast.label")),s(Ee,()=>i()("settings.display.highContrast.description")),s(a,h(k,{get when(){return he()},get children(){var e=c(Qe);return s(e,()=>i()("settings.display.autoSave")),e}}),Ke,Re),u(()=>F(a,`settings-form ${t.class||""}`)),u(()=>T(V,"checked",N())),u(()=>T(I,"checked",U())),a})()}De(["click"]);export{at as default};
