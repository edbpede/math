import{s as a}from"./client.D0X2hLWc.js";async function o(r,e){try{const{data:t,error:s}=await a.from("users").update({...e.gradeRange&&{grade_range:e.gradeRange},...e.locale&&{locale:e.locale},...e.preferences&&{preferences:e.preferences},last_active_at:new Date().toISOString()}).eq("id",r).select().single();return s?(console.error("Error updating user:",s),{success:!1,error:"Failed to update user",code:"UPDATE_FAILED"}):t?{success:!0,data:{user:{id:t.id,createdAt:new Date(t.created_at),lastActiveAt:new Date(t.last_active_at),gradeRange:t.grade_range,locale:t.locale,preferences:t.preferences||{}}}}:{success:!1,error:"User not found",code:"USER_NOT_FOUND"}}catch(t){return console.error("Unexpected error updating user:",t),{success:!1,error:"An unexpected error occurred",code:"UNEXPECTED_ERROR"}}}async function u(r){try{const{error:e}=await a.from("users").delete().eq("id",r);return e?(console.error("Error deleting user:",e),{success:!1,error:"Failed to delete user",code:"DELETE_FAILED"}):{success:!0,data:{deleted:!0}}}catch(e){return console.error("Unexpected error deleting user:",e),{success:!1,error:"An unexpected error occurred",code:"UNEXPECTED_ERROR"}}}async function l(){try{const r=await fetch("/api/auth/session",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});if(!r.ok)return console.error("Failed to fetch current user:",r.statusText),null;const e=await r.json();return!e.success||!e.authenticated||!e.user?null:{id:e.user.id,gradeRange:e.user.gradeRange,locale:e.user.locale,createdAt:new Date(e.user.createdAt),lastActiveAt:new Date(e.user.lastActiveAt),preferences:e.user.preferences||{}}}catch(r){return console.error("Error getting current user:",r),null}}export{u as d,l as g,o as u};
