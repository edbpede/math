import{d as e,b as t,m as n,C as r,y as s,g as i,h as a,i as l,f as o,l as d,r as u,t as c,n as g,w as b,o as y,j as x,k as h,A as f}from"./solid-core.DXeZPQOr.js";import{$networkStatus as m,$syncStatus as p,getTimeSinceLastSync as v,initializeStatusStores as w,triggerManualSync as k}from"./network-status.BrKK7yR3.js";import{$ as S}from"./exercises.qBB0Fcdg.js";import"./offline.Cje6W5Yz.js";import"./idb.B3QPy4uZ.js";import"./island-dashboard.BXXnSGgj.js";import"./mastery.Dl1Tnavr.js";import"./supabase.Bg7B0XWC.js";import"./vendor.DULspf60.js";import"./qrcode.C5UO-pJ-.js";var C=c('<span class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs font-semibold px-2 py-0.5 rounded-full">'),j=c('<div class="mb-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm"><span class="text-blue-800 dark:text-blue-200">'),$=c('<div class="mb-3 p-2 bg-red-50 dark:bg-red-900/20 rounded text-sm text-red-800 dark:text-red-200">'),q=c('<span class="flex items-center justify-center gap-2"><svg class="animate-spin h-4 w-4"viewBox="0 0 24 24"><circle class=opacity-25 cx=12 cy=12 r=10 stroke=currentColor stroke-width=4 fill=none></circle><path class=opacity-75 fill=currentColor d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><!$><!/>'),I=c('<button type=button class="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-medium py-2 px-4 rounded transition-colors">'),z=c('<div class="text-sm text-center text-gray-500 dark:text-gray-400 py-2">'),M=c('<div class="absolute bottom-full right-0 mb-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 p-4"><div class="flex items-center justify-between mb-3 pb-3 border-b border-gray-200 dark:border-gray-700"><h3 class="font-semibold text-gray-900 dark:text-white"></h3></div><div class=mb-3><div class="flex items-center gap-2 mb-1"><div></div><span class="text-sm text-gray-600 dark:text-gray-400"></span></div></div><!$><!/><div class="mb-3 text-sm text-gray-600 dark:text-gray-400"></div><!$><!/><!$><!/><!$><!/>'),A=c('<div class="fixed bottom-4 right-4 z-50"><button type=button class="flex items-center gap-2 bg-white dark:bg-gray-800 rounded-lg shadow-lg px-3 py-2 transition-all hover:shadow-xl"aria-label="Sync status"><div></div><span class="text-sm font-medium text-gray-700 dark:text-gray-300"></span><!$><!/><svg fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M19 9l-7 7-7-7"></path></svg></button><!$><!/>');function B(){const[e,c]=t(!1),[B,E]=t(!1),[D,F]=t(null),[H,K]=t("Never"),L=n(S),N=n(m),O=n(p);r(async()=>{try{await w()}catch(t){F("Initialization failed")}const e=setInterval(()=>{K(v())},1e4);y(()=>clearInterval(e))}),s(()=>{O()&&K(v())});const P=async()=>{if(N().online){E(!0),F(null);try{await k()}catch(e){F(e instanceof Error?e.message:L()("sync.errors.syncFailed"))}finally{E(!1)}}else F(L()("sync.errors.cannotSyncOffline"))},V=()=>N().online?O().syncing||B()?L()("sync.status.syncing"):O().error||D()?L()("sync.status.error"):O().queueCount>0?L()("sync.status.pending"):L()("sync.status.online"):L()("sync.status.offline");return(()=>{var t=i(A),n=t.firstChild,r=n.firstChild,s=r.nextSibling,y=s.nextSibling,[m,p]=a(y.nextSibling),v=m.nextSibling,w=n.nextSibling,[k,S]=a(w.nextSibling);return n.$$click=()=>c(!e()),l(s,V),l(n,o(x,{get when(){return O().queueCount>0},get children(){var e=i(C);return l(e,()=>O().queueCount),e}}),m,p),l(t,o(x,{get when(){return e()},get children(){var e,t=i(M),n=t.firstChild,r=n.firstChild,s=n.nextSibling,c=s.firstChild.firstChild,g=c.nextSibling,y=s.nextSibling,[m,p]=a(y.nextSibling),v=m.nextSibling,w=v.nextSibling,[k,S]=a(w.nextSibling),C=k.nextSibling,[A,E]=a(C.nextSibling),F=A.nextSibling,[K,V]=a(F.nextSibling);return l(r,()=>L()("sync.settings.title")),l(g,(e=h(()=>!!N().online),()=>e()?L()("sync.status.online"):L()("sync.status.offline"))),l(t,o(x,{get when(){return O().queueCount>0},get children(){var e=i(j),t=e.firstChild;return l(t,()=>L()("sync.ui.queueCount",{count:O().queueCount})),e}}),m,p),l(v,()=>L()("sync.ui.lastSync",{time:H()})),l(t,o(x,{get when(){return O().error||D()},get children(){var e=i($);return l(e,()=>O().error||D()),e}}),k,S),l(t,o(x,{get when(){return N().online},get children(){var e=i(I);return e.$$click=P,l(e,o(x,{get when(){return O().syncing||B()},get fallback(){return L()("sync.ui.manualSync")},get children(){var e=i(q),t=e.firstChild.nextSibling,[n,r]=a(t.nextSibling);return l(e,()=>L()("sync.ui.syncInProgress"),n,r),e}})),d(()=>f(e,"disabled",O().syncing||B()||0===O().queueCount)),u(),e}}),A,E),l(t,o(x,{get when(){return!N().online},get children(){var e=i(z);return l(e,()=>L()("sync.messages.offlineMode")),e}}),K,V),d(()=>b(c,"w-2 h-2 rounded-full "+(N().online?"bg-green-500":"bg-red-500"))),t}}),k,S),d(t=>{var s=e(),i=`w-3 h-3 rounded-full ${N().online?O().syncing||B()?"bg-yellow-500":O().error||D()?"bg-orange-500":O().queueCount>0?"bg-blue-500":"bg-green-500":"bg-red-500"} ${O().syncing||B()?"animate-pulse":""}`,a="w-4 h-4 transition-transform "+(e()?"rotate-180":"");return s!==t.e&&g(n,"aria-expanded",t.e=s),i!==t.t&&b(r,t.t=i),a!==t.a&&g(v,"class",t.a=a),t},{e:void 0,t:void 0,a:void 0}),u(),t})()}e(["click"]);export{B as default};
