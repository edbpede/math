import{d as e,m as t,b as s,g as i,t as r,h as n,i as l,f as a,j as o,l as d,n as c,w as u,r as g,u as b,F as x,k as m,B as h,M as f,v}from"./solid-core.DXeZPQOr.js";import{$ as p,g as y}from"./exercises.qBB0Fcdg.js";import{d as w,e as S,l as C,u as k}from"./island-dashboard.BXXnSGgj.js";import{E as $}from"./island-practice.hdHbQYU8.js";import"./mastery.Dl1Tnavr.js";import"./supabase.Bg7B0XWC.js";import"./vendor.DULspf60.js";import"./qrcode.C5UO-pJ-.js";var I=r('<div class="mb-8 p-4 bg-blue-50 border border-blue-200 rounded-lg"role=status aria-live=polite><p class="text-blue-800 text-sm">'),A=r('<div><div class=mb-8><h1 class="text-3xl font-bold text-gray-900 mb-2"></h1><p class="text-lg text-gray-600"></p></div><!$><!/><div class=mb-8><label id=difficulty-label class="block text-lg font-semibold text-gray-800 mb-4"></label><div role=radiogroup aria-labelledby=difficulty-label class=space-y-3></div></div><div class=mb-8><label id=count-label class="block text-lg font-semibold text-gray-800 mb-4"></label><div role=radiogroup aria-labelledby=count-label class=space-y-3></div></div><div class=mt-8><button type=button class="w-full py-4 px-6 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-lg rounded-lg transition-colors min-h-[44px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-md hover:shadow-lg">'),D=r('<div class="w-full h-full rounded-full bg-white scale-40">'),T=r('<button type=button role=radio><div class="flex items-start"><div aria-hidden=true></div><div class=flex-1><div class="font-semibold text-gray-900 mb-1"></div><div class="text-sm text-gray-600">');function U(e){const r=t(p),[b,x]=s(e.isFirstTime?"A":"Auto"),[m,h]=s(20),f=()=>{e.onStart({difficulty:b(),exerciseCount:m()})},v=[{value:"Auto",key:"auto"},{value:"A",key:"a"},{value:"B",key:"b"},{value:"C",key:"c"}],y=[{value:10,key:"10"},{value:20,key:"20"},{value:30,key:"30"}];return(()=>{var t=i(A),s=t.firstChild,p=s.firstChild,w=p.nextSibling,S=s.nextSibling,[C,k]=n(S.nextSibling),$=C.nextSibling,U=$.firstChild,j=U.nextSibling,E=$.nextSibling,P=E.firstChild,B=P.nextSibling,F=E.nextSibling.firstChild;return l(p,()=>r()("exercises.session.setup.title")),l(w,()=>r()("exercises.session.setup.subtitle")),l(t,a(o,{get when(){return e.isFirstTime},get children(){var e=i(I),t=e.firstChild;return l(t,()=>r()("exercises.session.setup.firstTimeNotice")),e}}),C,k),l(U,()=>r()("exercises.session.setup.difficulty.label")),l(j,()=>v.map(e=>{const t=()=>b()===e.value;return s=i(T),n=s.firstChild.firstChild,m=n.nextSibling.firstChild,h=m.nextSibling,s.$$click=()=>x(e.value),l(n,a(o,{get when(){return t()},get children(){return i(D)}})),l(m,()=>r()(`exercises.session.setup.difficulty.${e.key}`)),l(h,()=>r()(`exercises.session.setup.difficulty.${e.key}Description`)),d(e=>{var i=t(),r=`\n                  w-full text-left p-4 rounded-lg border-2 transition-all\n                  min-h-[44px] cursor-pointer\n                  ${t()?"border-blue-500 bg-blue-50 shadow-md":"border-gray-300 bg-white hover:border-blue-300 hover:bg-blue-50"}\n                  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n                `,l=`\n                      flex-shrink-0 w-5 h-5 rounded-full border-2 mt-0.5 mr-3\n                      ${t()?"border-blue-500 bg-blue-500":"border-gray-400 bg-white"}\n                    `;return i!==e.e&&c(s,"aria-checked",e.e=i),r!==e.t&&u(s,e.t=r),l!==e.a&&u(n,e.a=l),e},{e:void 0,t:void 0,a:void 0}),g(),s;var s,n,m,h})),l(P,()=>r()("exercises.session.setup.exerciseCount.label")),l(B,()=>y.map(e=>{const t=()=>m()===e.value;return s=i(T),n=s.firstChild.firstChild,b=n.nextSibling.firstChild,x=b.nextSibling,s.$$click=()=>h(e.value),l(n,a(o,{get when(){return t()},get children(){return i(D)}})),l(b,()=>r()(`exercises.session.setup.exerciseCount.${e.key}`)),l(x,()=>r()(`exercises.session.setup.exerciseCount.${e.key}Description`)),d(e=>{var i=t(),r=`\n                  w-full text-left p-4 rounded-lg border-2 transition-all\n                  min-h-[44px] cursor-pointer\n                  ${t()?"border-blue-500 bg-blue-50 shadow-md":"border-gray-300 bg-white hover:border-blue-300 hover:bg-blue-50"}\n                  focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n                `,l=`\n                      flex-shrink-0 w-5 h-5 rounded-full border-2 mt-0.5 mr-3\n                      ${t()?"border-blue-500 bg-blue-500":"border-gray-400 bg-white"}\n                    `;return i!==e.e&&c(s,"aria-checked",e.e=i),r!==e.t&&u(s,e.t=r),l!==e.a&&u(n,e.a=l),e},{e:void 0,t:void 0,a:void 0}),g(),s;var s,n,b,x})),F.$$click=f,l(F,()=>r()("exercises.session.setup.startButton")),d(()=>u(t,`session-setup ${e.class||""}`)),g(),t})()}e(["click"]);var j=r('<div class="mb-8 p-6 bg-yellow-50 border border-yellow-200 rounded-lg"><h2 class="text-lg font-semibold text-yellow-900 mb-4 text-center">Achievements Unlocked!</h2><div class="grid grid-cols-1 sm:grid-cols-2 gap-3">'),E=r('<div class=text-center><div class="text-3xl font-bold text-yellow-600 mb-1"></div><div class="text-sm text-gray-600">'),P=r('<div class=text-center><div class="text-3xl font-bold text-gray-600 mb-1"></div><div class="text-sm text-gray-600">'),B=r('<div class="text-center col-span-2"><div class="text-3xl font-bold text-indigo-600 mb-1">+<!$><!/></div><div class="text-sm text-gray-600">'),F=r('<div><div class="text-center mb-8"><div class="text-6xl mb-4"aria-hidden=true>üéâ</div><h1 class="text-3xl font-bold text-gray-900 mb-2"></h1><p class="text-xl text-gray-700"></p></div><!$><!/><div class="mb-8 p-6 bg-white border border-gray-200 rounded-lg shadow-sm"><h2 class="text-xl font-semibold text-gray-900 mb-6"></h2><div class="grid grid-cols-2 gap-6"><div class=text-center><div class="text-3xl font-bold text-blue-600 mb-1"></div><div class="text-sm text-gray-600"></div></div><div class=text-center><div class="text-3xl font-bold text-green-600 mb-1"></div><div class="text-sm text-gray-600"></div></div><div class=text-center><div class="text-3xl font-bold text-purple-600 mb-1"><!$><!/>%</div><div class="text-sm text-gray-600"></div></div><div class=text-center><div class="text-3xl font-bold text-orange-600 mb-1"></div><div class="text-sm text-gray-600"></div></div><!$><!/><!$><!/><!$><!/></div></div><div class=space-y-3><button type=button class="w-full py-4 px-6 bg-blue-600 hover:bg-blue-700 text-white font-semibold text-lg rounded-lg transition-colors min-h-[44px] focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-md hover:shadow-lg"></button><button type=button class="w-full py-4 px-6 bg-green-600 hover:bg-green-700 text-white font-semibold text-lg rounded-lg transition-colors min-h-[44px] focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 shadow-md hover:shadow-lg"></button><button type=button class="w-full py-4 px-6 bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold text-lg rounded-lg transition-colors min-h-[44px] focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 shadow-sm hover:shadow-md">'),M=r('<div class="flex items-center p-3 bg-white rounded-lg shadow-sm"><span class="text-2xl mr-3"aria-hidden=true>üèÜ</span><span class="text-sm font-medium text-gray-800">');function R(e){const s=t(p),r=b(()=>0===e.stats.totalExercises?0:Math.round(e.stats.correctCount/e.stats.totalExercises*100)),c=b(()=>{const t=Math.round(e.stats.avgTimeSeconds);return`${Math.floor(t/60)}:${(t%60).toString().padStart(2,"0")}`}),f=b(()=>{const e=r();return e>=90?s()("exercises.session.summary.excellentWork"):e>=70?s()("exercises.session.summary.goodProgress"):s()("exercises.session.summary.keepPracticing")}),v=b(()=>{const t=[];return 100===r()&&t.push("perfectScore"),0===e.stats.hintsUsed&&e.stats.correctCount>0&&t.push("noHints"),e.stats.avgTimeSeconds<30&&t.push("fastLearner"),e.stats.totalExercises>=30&&t.push("persistent"),t});return(()=>{var t=i(F),b=t.firstChild,p=b.firstChild.nextSibling,y=p.nextSibling,w=b.nextSibling,[S,C]=n(w.nextSibling),k=S.nextSibling,$=k.firstChild,I=$.nextSibling,A=I.firstChild,D=A.firstChild,T=D.nextSibling,U=A.nextSibling,R=U.firstChild,G=R.nextSibling,L=U.nextSibling,V=L.firstChild,q=V.firstChild,[H,N]=n(q.nextSibling);H.nextSibling;var W=V.nextSibling,z=L.nextSibling,J=z.firstChild,K=J.nextSibling,O=z.nextSibling,[Q,X]=n(O.nextSibling),Y=Q.nextSibling,[Z,_]=n(Y.nextSibling),ee=Z.nextSibling,[te,se]=n(ee.nextSibling),ie=k.nextSibling.firstChild,re=ie.nextSibling,ne=re.nextSibling;return l(p,()=>s()("exercises.session.summary.title")),l(y,f),l(t,a(o,{get when(){return v().length>0},get children(){var e=i(j),t=e.firstChild.nextSibling;return l(t,a(x,{get each(){return v()},children:e=>{return t=i(M),r=t.firstChild.nextSibling,l(r,()=>s()(`exercises.session.summary.achievements.${e}`)),t;var t,r}})),e}}),S,C),l($,()=>s()("exercises.session.summary.statistics.title")),l(D,()=>e.stats.totalExercises),l(T,()=>s()("exercises.session.summary.statistics.total")),l(R,()=>e.stats.correctCount),l(G,()=>s()("exercises.session.summary.statistics.correct")),l(V,r,H,N),l(W,()=>s()("exercises.session.summary.statistics.accuracy")),l(J,c),l(K,()=>s()("exercises.session.summary.statistics.avgTime")),l(I,a(o,{get when(){return e.stats.hintsUsed>0},get children(){var t=i(E),r=t.firstChild,n=r.nextSibling;return l(r,()=>e.stats.hintsUsed),l(n,()=>s()("exercises.session.summary.statistics.hintsUsed")),t}}),Q,X),l(I,a(o,{get when(){return e.stats.skippedCount>0},get children(){var t=i(P),r=t.firstChild,n=r.nextSibling;return l(r,()=>e.stats.skippedCount),l(n,()=>s()("exercises.session.summary.statistics.skipped")),t}}),Z,_),l(I,a(o,{get when(){return m(()=>void 0!==e.masteryGain)()&&e.masteryGain>0},get children(){var t=i(B),r=t.firstChild,a=r.firstChild.nextSibling,[o,d]=n(a.nextSibling),c=r.nextSibling;return l(r,()=>e.masteryGain,o,d),l(c,()=>s()("exercises.session.summary.statistics.masteryGain")),t}}),te,se),h(ie,"click",e.onPracticeAgain),l(ie,()=>s()("exercises.session.summary.actions.practiceAgain")),h(re,"click",e.onViewProgress),l(re,()=>s()("exercises.session.summary.actions.viewProgress")),h(ne,"click",e.onReturnToDashboard),l(ne,()=>s()("exercises.session.summary.actions.dashboard")),d(()=>u(t,`session-summary ${e.class||""}`)),g(),t})()}e(["click"]);var G=r('<div class="text-center py-12"><div class="text-red-600 text-xl font-semibold mb-4">Error</div><p class="text-gray-700 mb-6"></p><button type=button class="py-3 px-6 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">Try Again'),L=r("<div>");function V(e){const[t,r]=s("setup"),[n,o]=s(""),[c,x]=s([]),[h,p]=s(0),[I,A]=s(""),[D,T]=s(0),[j,E]=s(0),[P,B]=s(0),[F,M]=s(0),[V,q]=s(Date.now()),H=b(()=>c()[h()]||null),N=b(()=>h()>=c().length-1),W=async t=>{try{const s=await w(e.userId,e.gradeRange,e.competencyAreaId);o(s.id);const i="Auto"===t.difficulty?void 0:t.difficulty,n=await y({competencyAreaId:e.competencyAreaId,gradeRange:e.gradeRange,difficulty:i},t.exerciseCount,{locale:e.locale});x(n),p(0),q(Date.now()),r("practicing")}catch(s){A("Failed to start session. Please try again."),r("error")}},z=async t=>{try{const s=H();if(!s)return;const i=Math.round((Date.now()-V())/1e3);M(F()+i),t.correct&&T(D()+1),E(j()+t.hintsUsed),await C({userId:e.userId,sessionId:n(),templateId:s.templateId,competencyAreaId:e.competencyAreaId,skillId:s.metadata.skillId||"unknown",difficulty:s.metadata.difficulty,isBinding:s.metadata.isBinding,correct:t.correct,timeSpentSeconds:i,hintsUsed:t.hintsUsed,userAnswer:t.userAnswer});const r=h()+1;r%5==0&&await k(n(),r,D()),N()?await K():(p(h()+1),q(Date.now()))}catch(s){N()?await K():(p(h()+1),q(Date.now()))}},J=async t=>{try{const s=H();if(!s)return;const i=Math.round((Date.now()-V())/1e3);M(F()+i),B(P()+1),E(j()+t.hintsUsed),await C({userId:e.userId,sessionId:n(),templateId:s.templateId,competencyAreaId:e.competencyAreaId,skillId:s.metadata.skillId||"unknown",difficulty:s.metadata.difficulty,isBinding:s.metadata.isBinding,correct:!1,timeSpentSeconds:i,hintsUsed:t.hintsUsed,userAnswer:t.userAnswer||""}),N()?await K():(p(h()+1),q(Date.now()))}catch(s){N()?await K():(p(h()+1),q(Date.now()))}},K=async()=>{try{const e=c().length,t=e>0?F()/e:0;await S(n(),e,D(),t),r("complete")}catch(e){r("complete")}},O=()=>{o(""),x([]),p(0),T(0),E(0),B(0),M(0),r("setup")},Q=()=>{window.location.href="/dashboard"},X=()=>{window.location.href="/dashboard"},Y=b(()=>({totalExercises:c().length,correctCount:D(),avgTimeSeconds:c().length>0?F()/c().length:0,hintsUsed:j(),skippedCount:P()}));return Z=i(L),l(Z,a(v,{get children(){return[a(f,{get when(){return"setup"===t()},get children(){return a(U,{get isFirstTime(){return e.isFirstTime},onStart:W})}}),a(f,{get when(){return m(()=>"practicing"===t())()&&H()},get children(){return a($,{get exercises(){return c()},get currentIndex(){return h()},get sessionId(){return n()},onExerciseComplete:z,onSkip:J,onSessionComplete:K})}}),a(f,{get when(){return"complete"===t()},get children(){return a(R,{get stats(){return Y()},onPracticeAgain:O,onViewProgress:Q,onReturnToDashboard:X})}}),a(f,{get when(){return"error"===t()},get children(){var e=i(G),t=e.firstChild.nextSibling,s=t.nextSibling;return l(t,I),s.$$click=()=>r("setup"),g(),e}})]}})),d(()=>u(Z,`practice-session-wrapper max-w-4xl mx-auto px-4 py-8 ${e.class||""}`)),Z;var Z}e(["click"]);export{V as default};
