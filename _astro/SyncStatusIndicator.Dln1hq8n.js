import{d as e,b as t,m as r,C as n,y as s,g as i,h as l,i as a,f as o,l as d,r as u,t as c,j as g,k as b,A as x,n as h,w as f,o as y}from"./solid-core.DXeZPQOr.js";import{$networkStatus as m,$syncStatus as v,getTimeSinceLastSync as p,triggerManualSync as w,initializeStatusStores as k}from"./network-status.BEpDOitK.js";import{$ as C}from"./exercises.CmwZ4dJn.js";import"./offline.Bc__k3kr.js";import"./idb.B3QPy4uZ.js";import"./island-dashboard.Bt_Br7pH.js";import"./mastery.BYaRoLpV.js";import"./supabase.BYn26wLR.js";import"./vendor.CmgFkl6N.js";import"./qrcode.B15vZz8I.js";var S=c('<span class="bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs font-semibold px-2 py-0.5 rounded-full">'),j=c('<div class="mb-3 p-2 bg-blue-50 dark:bg-blue-900/20 rounded text-sm"><span class="text-blue-800 dark:text-blue-200">'),$=c('<p class="text-xs text-red-700 dark:text-red-300 mt-1">'),q=c('<div class="mb-3 p-3 bg-red-50 dark:bg-red-900/20 rounded border border-red-200 dark:border-red-800"><div class="flex items-start gap-2"><svg class="flex-shrink-0 w-5 h-5 text-red-600 dark:text-red-400 mt-0.5"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class=flex-1><p class="text-sm font-medium text-red-800 dark:text-red-200"></p><!$><!/>'),M=c('<span class="flex items-center justify-center gap-2"><svg class="animate-spin h-4 w-4"viewBox="0 0 24 24"><circle class=opacity-25 cx=12 cy=12 r=10 stroke=currentColor stroke-width=4 fill=none></circle><path class=opacity-75 fill=currentColor d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg><!$><!/>'),z=c('<button type=button class="w-full bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-medium py-2 px-4 rounded transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2">'),B=c('<p class="text-xs text-yellow-700 dark:text-yellow-300 mt-1">'),A=c('<div class="p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded border border-yellow-200 dark:border-yellow-800"><div class="flex items-start gap-2"><svg class="flex-shrink-0 w-5 h-5 text-yellow-600 dark:text-yellow-400 mt-0.5"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><div class=flex-1><p class="text-sm font-medium text-yellow-800 dark:text-yellow-200"></p><!$><!/>'),I=c('<div class="absolute bottom-full right-0 mb-2 w-80 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 p-4"><div class="flex items-center justify-between mb-3 pb-3 border-b border-gray-200 dark:border-gray-700"><h3 class="font-semibold text-gray-900 dark:text-white"></h3></div><div class=mb-3><div class="flex items-center gap-2 mb-1"><div></div><span class="text-sm text-gray-600 dark:text-gray-400"></span></div></div><!$><!/><div class="mb-3 text-sm text-gray-600 dark:text-gray-400"></div><!$><!/><!$><!/><!$><!/>'),H=c('<div class="fixed bottom-4 right-4 z-50"><button type=button class="flex items-center gap-2 bg-white dark:bg-gray-800 rounded-lg shadow-lg px-3 py-2 transition-all hover:shadow-xl"aria-label="Sync status"><div></div><span class="text-sm font-medium text-gray-700 dark:text-gray-300"></span><!$><!/><svg fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M19 9l-7 7-7-7"></path></svg></button><!$><!/>'),E=c('<span class="flex items-center justify-center gap-2"><svg class="w-4 h-4"fill=none stroke=currentColor viewBox="0 0 24 24"><path stroke-linecap=round stroke-linejoin=round stroke-width=2 d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg><!$><!/>');function F(){const[e,c]=t(!1),[F,N]=t(!1),[D,J]=t(null),[L,O]=t("Never"),P=r(C),R=r(m),V=r(v);n(async()=>{try{await k()}catch(t){J("Initialization failed")}const e=setInterval(()=>{O(p())},1e4);y(()=>clearInterval(e))}),s(()=>{V()&&O(p())});const G=async()=>{if(R().online){N(!0),J(null);try{await w()}catch(e){J(e instanceof Error?e.message:P()("sync.errors.syncFailed"))}finally{N(!1)}}else J(P()("sync.errors.cannotSyncOffline"))},K=()=>R().online?V().syncing||F()?P()("sync.status.syncing"):V().error||D()?P()("sync.status.error"):V().queueCount>0?P()("sync.status.pending"):P()("sync.status.online"):P()("sync.status.offline");return(()=>{var t=i(H),r=t.firstChild,n=r.firstChild,s=n.nextSibling,y=s.nextSibling,[m,v]=l(y.nextSibling),p=m.nextSibling,w=r.nextSibling,[k,C]=l(w.nextSibling);return r.$$click=()=>c(!e()),a(s,K),a(r,o(g,{get when(){return V().queueCount>0},get children(){var e=i(S);return a(e,()=>V().queueCount),e}}),m,v),a(t,o(g,{get when(){return e()},get children(){var e,t=i(I),r=t.firstChild,n=r.firstChild,s=r.nextSibling,c=s.firstChild.firstChild,y=c.nextSibling,m=s.nextSibling,[v,p]=l(m.nextSibling),w=v.nextSibling,k=w.nextSibling,[C,S]=l(k.nextSibling),H=C.nextSibling,[N,J]=l(H.nextSibling),O=N.nextSibling,[K,Q]=l(O.nextSibling);return a(n,()=>P()("sync.settings.title")),a(y,(e=b(()=>!!R().online),()=>e()?P()("sync.status.online"):P()("sync.status.offline"))),a(t,o(g,{get when(){return V().queueCount>0},get children(){var e=i(j),t=e.firstChild;return a(t,()=>P()("sync.ui.queueCount",{count:V().queueCount})),e}}),v,p),a(w,()=>P()("sync.ui.lastSync",{time:L()})),a(t,o(g,{get when(){return V().error||D()},get children(){var e=i(q),t=e.firstChild.firstChild.nextSibling,r=t.firstChild,n=r.nextSibling,[s,d]=l(n.nextSibling);return a(r,()=>V().error||D()),a(t,o(g,{get when(){return b(()=>!!R().online)()&&V().queueCount>0},get children(){var e=i($);return a(e,()=>P()("sync.messages.manualRetryAvailable")),e}}),s,d),e}}),C,S),a(t,o(g,{get when(){return R().online},get children(){var e=i(z);return e.$$click=G,a(e,o(g,{get when(){return V().syncing||F()},get fallback(){return(()=>{var e=i(E),t=e.firstChild.nextSibling,[r,n]=l(t.nextSibling);return a(e,()=>P()("sync.ui.manualSync"),r,n),e})()},get children(){var e=i(M),t=e.firstChild.nextSibling,[r,n]=l(t.nextSibling);return a(e,()=>P()("sync.ui.syncInProgress"),r,n),e}})),d(t=>{var r=V().syncing||F()||0===V().queueCount,n=P()("sync.ui.manualSync");return r!==t.e&&x(e,"disabled",t.e=r),n!==t.t&&h(e,"aria-label",t.t=n),t},{e:void 0,t:void 0}),u(),e}}),N,J),a(t,o(g,{get when(){return!R().online},get children(){var e=i(A),t=e.firstChild.firstChild.nextSibling,r=t.firstChild,n=r.nextSibling,[s,d]=l(n.nextSibling);return a(r,()=>P()("sync.messages.offlineMode")),a(t,o(g,{get when(){return V().queueCount>0},get children(){var e=i(B);return a(e,()=>P()("sync.ui.queueCount",{count:V().queueCount})),e}}),s,d),e}}),K,Q),d(()=>f(c,"w-2 h-2 rounded-full "+(R().online?"bg-green-500":"bg-red-500"))),t}}),k,C),d(t=>{var s=e(),i=`w-3 h-3 rounded-full ${R().online?V().syncing||F()?"bg-yellow-500":V().error||D()?"bg-orange-500":V().queueCount>0?"bg-blue-500":"bg-green-500":"bg-red-500"} ${V().syncing||F()?"animate-pulse":""}`,l="w-4 h-4 transition-transform "+(e()?"rotate-180":"");return s!==t.e&&h(r,"aria-expanded",t.e=s),i!==t.t&&f(n,t.t=i),l!==t.a&&h(p,"class",t.a=l),t},{e:void 0,t:void 0,a:void 0}),u(),t})()}e(["click"]);export{F as default};
